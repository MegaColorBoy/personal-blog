<!DOCTYPE html>
<html data-theme="" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Abdush Shakoor">
	
	<meta name="description" content="Writings, experiments & ideas.">
	<meta name="og:title" content="Abdush Shakoor's Weblog | Abdush Shakoor's Weblog" />
	<meta name="og:type" content="article" />
	<meta name="og:url" content="" />
	<meta name="og:description" content="Writings, experiments & ideas" />
	<meta name="og:site_name" content="Abdush Shakoor's Weblog | Abdush Shakoor's Weblog" />
	
	<meta name="robots" content="follow">
	<title>Abdush Shakoor's Weblog | Abdush Shakoor's Weblog </title>
	<link rel="stylesheet" href="/static/css/main.css" type="text/css">
	<link rel="stylesheet" href="/static/css/pygments.css" type="text/css">

	<link rel="apple-touch-icon" sizes="57x57" href="/static/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/static/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/static/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/static/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/static/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/static/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/static/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/static/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/static/favicon/png" sizes="192x192"  href="/static/favicon/android-icon-192x192.png">
<link rel="icon" type="image/static/favicon/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
<link rel="icon" type="image/static/favicon/png" sizes="96x96" href="/static/favicon/favicon-96x96.png">
<link rel="icon" type="image/static/favicon/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
<link rel="manifest" href="/static/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
	
	<!-- <script src="https://unpkg.com/phosphor-icons"></script> -->
	<!-- <script>
		if(localStorage.theme){
			document.documentElement.setAttribute('data-theme', localStorage.getItem("theme"));
		}
	</script> -->
</head>
<body class="">
	<!-- Navbar -->
	<header class="header">
	<!-- Logo with Author Name -->
	<div class="author">
		<a href="/">
			<img src="/static/logo.png" alt="megacolorboy">
			<div class="name">
				<h1>Abdush Shakoor's Weblog</h1>
				<p>Writings, experiments & ideas.</p>
			</div>
		</a>
	</div>
	<!-- Logo with Author Name -->
	<nav>
		<ul class="menu">
			
				<li><a href="/about">About</a></li>
			
				<li><a href="/archive">Archive</a></li>
			
				<li><a href="/resume">Resume</a></li>
			
		</ul>
	</nav>	
</header>

<main>
	<div class="two-col-grid">
		<!-- Displays 4-5 full articles  -->
		<section id="primary">
			<div class="articles">
				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--implement-repeatingkey-xor">The Cryptopals Crypto Challenges: Set 1 - Implement Repeating-Key XOR</a></h1>
		<p class="description">Write a method that encrypts messages using the Repeating-Key XOR method with a given key.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/5">fifth challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided walkthroughs for the previous challenges, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encoding--decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--detect-singlecharacter-xor">The Cryptopals Crypto Challenges: Set 1 - Detect Single-Character XOR</a></li>
</ul>

<p>For this challenge, you have to implement a <strong><em>Repeating-Key XOR</em></strong> method to encrypt the following message:</p>

<div class="codehilite">
<pre><span></span><code>Burning &#39;em, if you ain&#39;t quick and nimble
I go crazy when I hear a cymbal
</code></pre>
</div>

<p>With a given key:</p>

<div class="codehilite">
<pre><span></span><code>ICE
</code></pre>
</div>

<p>The final message should look like this:</p>

<div class="codehilite">
<pre><span></span><code>0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272
a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f
</code></pre>
</div>

<p>If you've already understood the concept of <a href="/posts/base64-encoding-decoding-using-bitwise-manipulation-in-c">XOR</a> and had no issues implementing both <a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">Fixed XOR Cipher</a> and <a href="/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">Single-Byte XOR Cipher</a>, then this should be a piece of cake for you when it comes to implementing <strong><em>Repeating-Key XOR Cipher</em></strong>.</p>

<h2>How does this work?</h2>

<p>With <strong><em>Repeating-Key XOR</em></strong>, you'll sequentially apply each byte of the key (which is "ICE", in this case); the first byte of plaintext will be XOR'd against <strong><em>"I"</em></strong>, the next <strong><em>"C"</em></strong>, the next <strong><em>"E"</em></strong>, then <strong><em>"I"</em></strong> again for the 4th byte, and so on.</p>

<p>You can use this method to encrypt anything you want. Emails, Passwords, Secret messages and so on. You'll definitely get a feel for it because things will get interesting after this challenge.</p>

<p>Let's dive in to the code:</p>

<p><strong>Implementation of the method(s):</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Convert ASCII to HEX</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::con_ascii_2_hex</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">//Repeating Key XOR implementation</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::repeatingKeyXOR</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        1. Perform XOR against each character of the message </span>
<span class="cm">        against each character of the key. </span>
<span class="cm">        So if the key was &quot;ICE&quot; and the message is &quot;abcdefg&quot;,</span>
<span class="cm">        it would be &quot;a&quot; against &quot;I&quot;, then &quot;b&quot; against &quot;C&quot; and &quot;c&quot; against &quot;E&quot;</span>
<span class="cm">        but once it reaches the key&#39;s limit, you start again from the beginning</span>
<span class="cm">        of the key, which should be like: &quot;d&quot; against &quot;I&quot;, &quot;e&quot; against &quot;C&quot; and so on.</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">[</span><span class="n">count</span><span class="p">];</span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>

<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">key</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="mi">-1</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">count</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//2. Convert the ASCII message to Hexadecimal</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">final</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">con_ascii_2_hex</span><span class="p">(</span><span class="n">newStr</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">final</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Final code:</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Cryptopals Set 1 Challenge 5</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//Test cases provided</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Burning &#39;em, if you ain&#39;t quick and nimble I go crazy when I hear a cymbal&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ICE&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ENCODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">repeatingKeyXOR</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong><em>Note: This solution and the library named <mark>crypto.h</mark> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Stay tuned for the next challenge!</p>

	</div>
	<div class="article-footer">
		<time>December 15th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR Cipher</a></h1>
		<p class="description">Write a method that decrypts a hexadecimal message that has been XOR'd against a single character.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/3">third challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided walkthroughs for the previous challenges, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encoding--decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR Cipher</a></li>
</ul>

<p>For this challenge, you have to write a method that decodes a
Hexadecimal string:</p>

<div class="codehilite">
<pre><span></span><code>1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736
</code></pre>
</div>

<p>That has been <strong><em>XOR'd</em></strong> against a <strong><em>single character</em></strong>. You must find the key and decrypt the message.</p>

<p>If you have read the <a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">previous article</a>, it was clearly setup for this problem. There are so many ways to solve this problem but the most efficient way to solve it is by using a <strong><em>Frequency table</em></strong>.</p>

<p>Assuming the message is supposed to be in English, when decrypted, we need to only generate a frequency table using the given Hexadecimal string that shows the frequencies of each <strong><em>alphabet</em></strong>. The character that has the highest frequency is the key required, which is then used to perform an <strong><em>XOR (\^)</em></strong> operation against each character, to decrypt the encrypted message.</p>

<p>Let's have a look at the code:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Return Character frequency of a string</span>
<span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">frequency_table</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">it</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">it</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">m</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Return character with the highest frequency</span>
<span class="kt">char</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">ret_high_freq_char</span><span class="p">(</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">max_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">max_char</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">p</span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">isalpha</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_count</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">max_char</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
<span class="w">                </span><span class="n">max_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">max_char</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Single Byte XOR</span>
<span class="n">string</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">singleByteXOR</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//1. Convert Hexadecimal to Binary</span>
<span class="w">    </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_spaces</span><span class="p">(</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">str</span><span class="p">),</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>

<span class="w">    </span><span class="c1">//2. Convert Binary to Decimals</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0</span><span class="p">);</span>


<span class="w">    </span><span class="c1">// What&#39;s happening here?</span>
<span class="w">    </span><span class="c1">// 4. Generate a frequency table using the characters from the ASCII string</span>
<span class="w">    </span><span class="c1">// 5. Look for characters that are English and also has the highest frequency</span>
<span class="w">    </span><span class="c1">// 6. The character that has the highest frequency is the KEY!</span>

<span class="w">    </span><span class="c1">//The key</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">toupper</span><span class="p">(</span><span class="n">ret_high_freq_char</span><span class="p">(</span><span class="n">frequency_table</span><span class="p">(</span><span class="n">con_dec_2_ascii</span><span class="p">(</span><span class="n">v</span><span class="p">))));</span>

<span class="w">    </span><span class="c1">//7. Perform XOR with the KEY against each character</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//8. Decoded message</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Final code:</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//CryptoPals Set 1 Challenge 3</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//Test case provided</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;DECODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">singleByteXOR</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span><span class="w">   </span>
</code></pre>
</div>

<p><strong>Decrypted message:</strong></p>

<div class="codehilite">
<pre><span></span><code>Key with the highest frequency: &#39;X&#39;
Message: Cooking MC&#39;s like a pound of bacon
</code></pre>
</div>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Stay tuned for the next challenge!</p>

	</div>
	<div class="article-footer">
		<time>December 13th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--detect-singlecharacter-xor">The Cryptopals Crypto Challenges: Set 1 - Detect Single-Character XOR</a></h1>
		<p class="description">Write a method that derives which string that has a length of 60 characters has been encrypted using Single-Byte XOR cipher.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/4">fourth challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided walkthroughs for the previous challenges, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encoding-decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR Cipher</a></li>
</ul>

<p>For this challenge, given a <a href="http://cryptopals.com/static/challenge-data/4.txt">list</a> of encrypted strings, you must derive which string (that has a length of 60 characters) is encrypted using <strong><em>Single-Byte XOR Cipher</em></strong>.</p>

<p>Similar to the <a href="/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">previous post</a>, this is more about breaking the <strong><em>Single-Byte XOR Cipher</em></strong> technique. Remember, you can solve this challenge only if you were able to solve the previous challenge because you'll have to tweak some of the previous code in this challenge.</p>

<h2>How to detect Single-Byte XOR?</h2>

<p>In the previous challenge, we're able to determine the key as we had one string but how do we do that with 300+ strings in a file except now that we also have to determine if the string is encrypted using <strong><em>Single-Byte XOR Cipher</em></strong> or not?</p>

<p>Here's comes the interesting part:</p>

<ol>
<li>Select the string that has the most english letters from the file</li>
<li>Perform a Brute-force XOR on the string with the most english letters in which each character is XOR'd against every character from the ASCII table (256 characters)</li>
<li>Pick the most english string after brute-forcing with each character</li>
<li>Display the final result</li>
</ol>

<p>Let's have a look at the code:</p>

<p><strong>Implementation of the method(s):</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Return Character frequency of a string</span>
<span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">frequency_table</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">it</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">it</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">m</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Return integer with the highest frequency of alphabets</span>
<span class="kt">int</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">high_frequency_count</span><span class="p">(</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="n">m</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">p</span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">isalpha</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// cout &lt;&lt; p.first &lt;&lt; &quot;:&quot; &lt;&lt; p.second &lt;&lt; &quot; &quot;;</span>
<span class="w">            </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Detect string with Single Byte XOR</span>
<span class="n">string</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">detectSingleByteXOR</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxV</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">maxCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        2. Perform a Brute-force XOR on the string that has</span>
<span class="cm">        the most english letters in which each character is XOR&#39;d against</span>
<span class="cm">        every character from the ASCII table (256 characters)</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">256</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">maxV</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxV</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">            </span><span class="n">temp</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">tolower</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//3. Select the string that has the most english letters. again.</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">high_frequency_count</span><span class="p">(</span><span class="n">frequency_table</span><span class="p">(</span><span class="n">temp</span><span class="p">));</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxCount</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">maxCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">            </span><span class="k">final</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//4. Display the most &quot;english&quot; text as the final result</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">final</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Final code:</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Cryptopals Set 1 Challenge 4</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span>

<span class="w">    </span><span class="n">ifstream</span><span class="w"> </span><span class="n">infile</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">maxCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">maxString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxV</span><span class="p">;</span>

<span class="w">    </span><span class="n">infile</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;enctext.txt&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">//if the file is not there</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">infile</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Unable to open the file&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">infile</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//Only look for strings with 60 char length</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">add_spaces</span><span class="p">(</span><span class="n">crypt</span><span class="p">.</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">str</span><span class="p">),</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">            </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0</span><span class="p">);</span>
<span class="w">            </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_dec_2_ascii</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span>

<span class="w">            </span><span class="c1">//1. Select the string that has the most english letters</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">high_frequency_count</span><span class="p">(</span><span class="n">crypt</span><span class="p">.</span><span class="n">frequency_table</span><span class="p">(</span><span class="n">newStr</span><span class="p">));</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxCount</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">maxCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">                </span><span class="n">maxString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="w">                </span><span class="n">maxV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v1</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//2. Pass the list of decimals to the function (for now)</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">detectSingleByteXOR</span><span class="p">(</span><span class="n">maxV</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Decrypted message:</strong></p>

<div class="codehilite">
<pre><span></span><code>Message: Now that the party is jumping.
</code></pre>
</div>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Stay tuned for the next challenge!</p>

	</div>
	<div class="article-footer">
		<time>December 13th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR</a></h1>
		<p class="description">Write a method that takes two strings of fixed equal length and produce their XOR combination.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/2">second challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided a walkthrough for the first challenge, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encoding--decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
</ul>

<p>For this challenge, you must write a method that takes two strings of fixed equal length and produce their XOR combination:</p>

<p>When you feed the following Hexadecimal string:</p>

<div class="codehilite">
<pre><span></span><code>1c0111001f010100061a024b53535009181c
</code></pre>
</div>

<p>And perform an XOR operation against another Hexadecimal string:</p>

<div class="codehilite">
<pre><span></span><code>686974207468652062756c6c277320657965
</code></pre>
</div>

<p>The method should return the following result:</p>

<div class="codehilite">
<pre><span></span><code>746865206b696420646f6e277420706c6179
</code></pre>
</div>

<p>Like the <a href="/posts/the-cryptopals-crypto-challenges-set-1-convert-hex-to-base64">first challenge</a>, this is sort of a warmup and a simple challenge to tackle. Just to give you a heads up, every challenge that you solve in this set would all make sense, in the end, as the challenges will get tougher and much more interesting.</p>

<h2>How do I solve this?</h2>

<p>As I mentioned above, this problem is simple and pretty straightforward. In my previous post, I talked about Bitwise Manipulations and it's operators, I will be using the <strong><em>XOR (\^)</em></strong> operator, if you want to know more about it, <a href="/posts/base64-encoding--decoding-using-bitwise-manipulation-in-c">check out my previous post</a>. Also, I will reuse some of the functions that I had used in the <strong>first challenge</strong>. So let's dive in to the code:</p>

<p><strong>Methods that are being reused:</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Hashmap that contain hex key and binary values</span>
<span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">gen_hex_table</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">map</span><span class="p">;</span>

<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;0&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0000&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;1&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0001&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;2&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0010&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;3&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0011&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;4&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0100&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;5&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0101&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;6&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0110&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;7&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0111&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;8&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1000&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;9&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1001&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1010&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;b&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1011&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;c&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1100&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;d&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1101&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;e&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1110&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;f&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1111&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">map</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Convert hex to string</span>
<span class="n">string</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">hexStr</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gen_hex_table</span><span class="p">();</span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">hexStr</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">isdigit</span><span class="p">(</span><span class="n">hexStr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">hexStr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">hexStr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// newStr += m.find(hexStr[i])-&gt;second;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Convert binary to decimal</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">power</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">istringstream</span><span class="w"> </span><span class="nf">iss</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">iss</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">power</span><span class="p">;</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">decimal</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">p</span><span class="o">--</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">decimal</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Add spaces between strings</span>
<span class="n">string</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">add_spaces</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">spaces</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// newStr += str[i];</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">spaces</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="w">            </span><span class="n">i</span><span class="o">--</span><span class="p">;</span>
<span class="w">            </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">            </span><span class="n">count</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Convert ASCII to HEX</span>
<span class="n">string</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">con_ascii_2_hex</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Implementation of the method:</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Fixed XOR implementation</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::fixedXOR</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str1</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">//Check if the length of both the strings are equal</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">str1</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">str2</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;The strings are not of equal length.&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>

<span class="w">        </span><span class="c1">//Step 1. convert hex to binary of 8 bits</span>
<span class="w">        </span><span class="n">str1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_spaces</span><span class="p">(</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">str1</span><span class="p">),</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">        </span><span class="n">str2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_spaces</span><span class="p">(</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">str2</span><span class="p">),</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//Step 2. convert binary to decimal</span>
<span class="w">        </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0</span><span class="p">);</span>
<span class="w">        </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//Step 3. XOR the decimals of v1 with decimals of v2</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">v1</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//Get the char of the first string</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">            </span><span class="c1">//Get the char of the second string</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v2</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

<span class="w">            </span><span class="c1">//Perform XOR operation against each other</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>

<span class="w">            </span><span class="c1">//Concatenate the string</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//ASCII result: the kid don&#39;t play.</span>

<span class="w">        </span><span class="c1">//Final result - Convert the ASCII string to Hexadecimal</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">con_ascii_2_hex</span><span class="p">(</span><span class="n">newStr</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Final code:</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//CryptoPals Set 1 Challenge 2</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//The test cases provided</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1c0111001f010100061a024b53535009181c&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;686974207468652062756c6c277320657965&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">fixedXOR</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Stay tuned for the next challenge!</p>

	</div>
	<div class="article-footer">
		<time>December 12th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/base64-encoding--decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></h1>
		<p class="description">An alternate solution to the previous post on how to encode/decode hexadecimals to Base64 and vice-versa using Bitwise Manipulation.</p>
	</div>
	<div class="article-body">
		<p>In the <a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">previous post</a>, I provided the walkthrough for the first challenge of Set 1 in The Cryptopals Crypto Challenges website but then I realized that I didn't write a method that could decode the Base64 string back to it's original Hexadecimal format. So I went back to the website again and found an important rule that I should have not ignored, at the very beginning:</p>

<blockquote>
  <p>Cryptopals Rule:</p>
  
  <p>Always operate on raw bytes, never on encoded strings. Only use Hex
  and Base64 for pretty-printing.</p>
</blockquote>

<p>Although, the solution I had provided in the first one works, but there's no way that I could go back to displaying the original Hexadecimal string. So I went on <strong>Wikipedia</strong> and did some research on Base64 and I figured out that I should brush up my knowledge on <a href="https://en.wikipedia.org/wiki/Bit_manipulation">Bitwise Manipulation</a> as I never had a use for it until now.</p>

<p>In this post, which should be pretty much straightforward (and probably longer too), I will be talking about Bitwise Manipulation and it's operators and also provide an alternate walkthrough for the first challenge of The Cryptopals Crypto Challenges.</p>

<h2>What is Bitwise Manipulation?</h2>

<p>Bitwise Manipulation is a low-level, algorithmic technique used to manipulate bits or data that are shorter than a word. This technique is mostly used on embedded controls, data compression, encryption algorithms and error-detection.</p>

<p>As I mentioned above, most programmers don't get to use this technique a lot as most programming languages allows the programmer to work on abstractions directly instead of bits that represent those abstractions.</p>

<p>A program that implements bitwise manipulation, makes use of the following operators:</p>

<ul>
<li>Bit Shifts (&lt;&lt; / &gt;&gt;)</li>
<li>AND (&amp;)</li>
<li>OR (|)</li>
<li>NOT (!)</li>
<li>XOR (\^)</li>
</ul>

<h3>Bit Shift operations</h3>

<p>Let's take a look at both the left <strong><em>&lt;&lt;</em></strong> and right <strong><em>&gt;&gt;</em></strong> shift operators. So if you use either of them, you would be shifting <strong><em>x</em></strong> number of bits to left or right in a variable.</p>

<p>Let's say we have the number <strong><em>x = 4</em></strong>, and it's binary form is <strong><em>00000100</em></strong> and we wanted to shift by 4 bits to the left, we just have to call <strong><em>x &lt;&lt; 4</em></strong>, the result would be <strong><em>00100000</em></strong>, which means <strong><em>x = 64</em></strong>. Shifting to the left is the equivalent of multiplication by the power of <strong><em>n</em></strong> because <strong><em>4x2^4^ = 64</em></strong>. Similarly, shifting to the right is the equivalent of division by the power of <strong><em>n</em></strong> because <strong><em>4 / 2^4^ = 4</em></strong> and it's binary form would be <strong><em>00000100</em></strong>.</p>

<h3>AND, OR and NOT operations</h3>

<p>The bitwise operator <strong>AND</strong> is useful, when you want to check a bit is on or off i.e. <strong><em>0</em></strong> or <strong><em>1</em></strong>. Whereas for the bitwise operator <strong>OR</strong> is the exact opposite, if either bit is on, then the result will be <strong><em>1</em></strong>, else it will be <strong><em>0</em></strong>. Finally, the bitwise operator <strong>NOT</strong> is used for inverting the bits in a binary, for example, if you had a binary string of <strong><em>00101000</em></strong>, you'd get <strong><em>11010111</em></strong>, it is used best when you want to turn off a bit combined with the <strong>AND</strong> operator.</p>

<h3>XOR operator</h3>

<p>Relax, this ain't scary, this is also known as <strong>Exclusive-OR</strong>. This operator works when both bits that are compared are either <strong><em>0</em></strong> or <strong><em>1</em></strong>, then the result will be <strong><em>0</em></strong>, else it will be <strong><em>1</em></strong>. So if you perform an XOR on <strong><em>01001000</em></strong> and <strong><em>01000100</em></strong>, the result will be <strong><em>00001100</em></strong>.</p>

<p>I hope that by now, you must have understood the basic concept of Bitwise Manipulation, if not, then spend some time reading about it before scrolling down to the next topic i.e. on how it's applied to encode and decode Hexadecimal strings to Base64 strings and vice-versa.</p>

<h2>Base64 Encoding</h2>

<p>Before you get started, please keep a couple of things in your mind:</p>

<ul>
<li>Each Hexadecimal character has 4 bits (Base 16)</li>
<li>Each Base64 character has 6 bits (Base 32)</li>
<li>We will be using the standard MIME-Base64 Encoding, thus we will have to use <strong><em>'+'</em></strong> and <strong><em>'/'</em></strong> characters as well</li>
</ul>

<p>Now that we have the facts, doing a simple math states that every 3 Hexadecimal characters is equal to 2 Base64 characters, since the least common multiple between 4 and 6 is 12. In order to do this, we are going to make use of our Bitwise Operators, let's have a look at the method:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Base64 Encoder</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::b64_encode</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//Number of bytes per 12 bits</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//Padding must be either 0 or 1</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">padding</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//Number of characters to be encoded is 3</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>

<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">+=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">//iterate every 3 chars</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//Get every 3 chars</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>

<span class="w">        </span><span class="c1">//Now, convert each hex character (base 16) to it&#39;s equivalent decimal number</span>
<span class="w">        </span><span class="c1">//and merge them into one variable</span>
<span class="w">        </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strtoull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="c1">//shift left by 8 bits</span>
<span class="w">        </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">strtoull</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="c1">//shift left by 4 bits</span>
<span class="w">        </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">strtoull</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span><span class="w"> </span><span class="c1">//no shift required only the first 2 characters need</span>

<span class="w">        </span><span class="c1">//HEX: 0x3F -&gt; DEC: 63 -&gt; ASCII: ?</span>

<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0x3F</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">)];</span><span class="w"> </span><span class="c1">//first b64 char; shift to right by 6 bits</span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0x3F</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">h</span><span class="p">];</span><span class="w"> </span><span class="c1">//second b64 char</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//if padding is required</span>
<span class="w">    </span><span class="c1">//Follows the same pattern as the above.</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">padding</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">        </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strtoull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="c1">// shift left by 8 bits</span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0x3F</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">)];</span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">//add this towards the end of the encoded string</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>If you're wondering on how to convert an ASCII string, all you have to do is convert the ASCII string to a Hexadecimal string and then use this method to give you the Base64 encoded string.</p>

<h2>Base64 Decoding</h2>

<p>What if you wanted to get back to the original string? Well, that's what we are going to do next. Unlike the previous post, you might have noticed that I didn't use any Hashmaps for encoding the Base64 characters, I wanted to try a different approach and also thought of increasing speed and efficiency and of course, keeping it simple.</p>

<p>Let's take a look at the method:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Base64 Decoder</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::b64_decode</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0123456789abcdef&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//Check if this is a valid b64 string</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//Number of bytes for hexadecimals</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">build</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">convert</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">make_entry</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">ssg</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="n">ssg</span><span class="p">.</span><span class="n">pyc</span><span class="w"> </span><span class="n">templates</span><span class="w"> </span><span class="n">transfer</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">venv</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">//iterate every 2 chars</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">h</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="c1">//shift 6 bits to the left</span>

<span class="w">            </span><span class="c1">//Check if the value is in the range of A-Z</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x41</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x5a</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0x41</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">//Check if the value is in the range of a-z</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x61</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x7a</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0x47</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">//Check if the value is in the range of 0-9</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x30</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x39</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x04</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">//Check if the value is a &#39;+&#39;</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x2b</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0x3e</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">//Check if the value is a &#39;/&#39;</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x2f</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0x3f</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">//Check if the value is a &#39;=&#39;</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x3d</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0xf</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)];</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">//Shift to the right by 8 bits</span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0xf</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)];</span>
<span class="w">        </span><span class="c1">//Shift to the right by 4 bits</span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0xf</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)];</span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0xf</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">h</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>In the final code, I just converted an ASCII string to Base64 string, let's have a look at it:</p>

<p><strong>Methods to convert ASCII string to Hexadecimal string and vice-versa:</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Convert ASCII to HEX</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::con_ascii_2_hex</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">//Convert HEX to ASCII</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::con_hex_2_ascii</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_spaces</span><span class="p">(</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">str</span><span class="p">),</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">    </span><span class="n">vector</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Final Code:</strong></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//CryptoPals Set 1 Challenge 1</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_ascii_2_hex</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">enc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">b64_encode</span><span class="p">(</span><span class="n">str</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ENCODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">enc</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">dec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_hex_2_ascii</span><span class="p">(</span><span class="n">crypt</span><span class="p">.</span><span class="n">b64_decode</span><span class="p">(</span><span class="n">enc</span><span class="p">));</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;DECODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">dec</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Hope you guys liked reading this article!</p>

<p>Until next time, then!</p>

	</div>
	<div class="article-footer">
		<time>December 11th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/algorithms/">
					Algorithms
				</a>
			</li>
			
			<li>
				<a href="/category/programming/">
					Programming
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></h1>
		<p class="description">Convert Hexadecimal strings to encoded Base64 strings.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/1">first challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. If you want to know more about these challenges, look at my <a href="/posts/the-cryptopals-crypto-challenges">previous post</a>.</p>

<p>For this challenge, you need to be able to convert Hexadecimal strings to encoded Base64 strings:</p>

<p>The string:</p>

<div class="codehilite">
<pre><span></span><code>49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d
</code></pre>
</div>

<p>Should produce:</p>

<div class="codehilite">
<pre><span></span><code>SSdtIGtpbGxpbmcgeW91ciBicmFpbiBsaWtlIGEgcG9pc29ub3VzIG11c2hyb29t
</code></pre>
</div>

<p>Not only is this challenge just a warmup but it is also designed to make you feel comfortable in dealing with raw bytes as Base64 is used to encode binary information and Hexadecimal is used to view the raw bytes.</p>

<h2>How to convert from Hexadecimal to Base64?</h2>

<p>Well, it's simpler than you think! You will have to go through the following steps:</p>

<ol>
<li><a href="#step-1">Convert hexadecimal string to binary string</a></li>
<li><a href="#step-2">Split the binary string into 4 pieces of 6 bits each</a></li>
<li><a href="#step-3">Convert the binary string to decimal</a></li>
<li><a href="#step-4">Compare each decimal against each character in a reference string of 64 characters</a></li>
</ol>

<h3><a id="step-1"></a> Convert hexadecimal string to binary string</h3>

<p>Before converting to binary, you should compare each character against a hashmap table of hardcoded hexadecimal keys and binary values.</p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Hashmap that contain hex key and binary values</span>
<span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">gen_hex_table</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">map</span><span class="p">;</span>

<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;0&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0000&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;1&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0001&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;2&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0010&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;3&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0011&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;4&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0100&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;5&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0101&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;6&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0110&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;7&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0111&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;8&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1000&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;9&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1001&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1010&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;b&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1011&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;c&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1100&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;d&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1101&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;e&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1110&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">map</span><span class="p">[</span><span class="sc">&#39;f&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1111&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">map</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Convert hex to string</span>
<span class="n">string</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">hexStr</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gen_hex_table</span><span class="p">();</span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="n">hexStr</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">isdigit</span><span class="p">(</span><span class="n">hexStr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">hexStr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">hexStr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// newStr += m.find(hexStr[i])-&gt;second;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h3><a id="step-2"></a> Split the binary string into 4 pieces of 6 bits each</h3>

<p>Base64 represents data in the form of ASCII format that follows a Radix-64 representation. Each character is picked from a set of 64 characters, which means that I'll only need 6 bits represent each character because <strong>2<sup>6</sup> = 64 characters</strong>.</p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Add spaces between strings</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::add_spaces</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">spaces</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// newStr += str[i];</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">spaces</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">;</span>
<span class="w">            </span><span class="n">i</span><span class="o">--</span><span class="p">;</span>
<span class="w">            </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">            </span><span class="n">count</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h3><a id="step-3"></a> Convert the binary string to decimal</h3>

<p>Before converting, you should know that a decimal number is equal to the sum of binary digits (d~n~) times their power of 2 (2<sup>n</sup>).</p>

<p>Let's say you have a binary string of <mark>111001</mark>, it's decimal
would be <mark>1x2<sup>5</sup> + 1x2<sup>4</sup> + 1x2<sup>3</sup> + 0x2<sup>2</sup> + 0x2<sup>1</sup> + 1x2<sup>0</sup> =
57</mark></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Convert binary to decimal</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">power</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">istringstream</span><span class="w"> </span><span class="nf">iss</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">iss</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">power</span><span class="p">;</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">decimal</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">p</span><span class="o">--</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">decimal</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h3><a id="step-4"></a> Compare each decimal against each character in a reference string of 64 characters</h3>

<p>At this stage, all you have to do is find and concatenate each character (using the reference string) based on each decimal and return your encoded Base64 string as the final output.</p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Convert HEX to Base 64</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::con_hex_2_b64</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">b64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_spaces</span><span class="p">(</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">str</span><span class="p">),</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">newStr</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">b64</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">b64</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Here's the final section of the code:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//CryptoPals Set 1 Challenge 1</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//Test case provided from the site</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_hex_2_b64</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Stay tuned for the next challenge.</p>

	</div>
	<div class="article-footer">
		<time>December 6th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></h1>
		<p class="description">Came across an interesting website that hosts cryptographic challenges based on real world cryptography.</p>
	</div>
	<div class="article-body">
		<p>Last week, I came across an interesting website named <a href="http://cryptopals.com/">The Cryptopals
Crypto Challenges</a> (also known as The Matasano
Crypto Challenges) that hosts cryptographic challenges based on
real-world cryptography that makes use of various ciphers and secure
protocols.</p>

<h2>What is it about?</h2>

<p>These challenges were developed by a security team called <a href="https://www.nccgroup.trust/us/">NCC
Security</a>, which is developed as a tool
for teaching <a href="https://en.wikipedia.org/wiki/Cryptography">Cryptography</a>.</p>

<p>Currently, there are eight sets of problems in which each set gets
progressively harder as you solve them. As I'm writing this post, I'm
solving the <a href="http://cryptopals.com/sets/1">first set</a> of problems, these
problems are designed in such a way that you get to build own
cryptographic functions/utilities and exploit them. Most importantly,
not only do these challenges give you an overview on how to build secure
cryptographic systems but also you'll get an understanding on how
they're being attacked.</p>

<p>In the first few challenges, I was exposed to some crypto math but these
concepts weren't that hard as it was more practical and gentler:</p>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Modular_arithmetic">Modular arithmetic</a></li>
<li>Working with different bases such as Base 2 and Base 16</li>
<li><a href="http://en.wikipedia.org/wiki/Hamming_distance">Hamming Distance</a></li>
<li><a href="https://en.wikipedia.org/wiki/Standard_deviation">Standard Deviation and Variance</a></li>
<li><a href="https://en.wikipedia.org/wiki/Frequency_(statistics)">Frequency</a></li>
</ul>

<p>Also, I found myself using different techniques to solve these
challenges such as:</p>

<ul>
<li>String manipulation</li>
<li>Lookup tables / Hashmaps</li>
<li>Conversion of string to integer and vice-versa</li>
<li>Bitwise operators</li>
</ul>

<p>Like I had mentioned above, this is also designed as a tool to learn
cryptography, which means you don't really need to have prior knowledge
of cryptography and security. It's all about doing your own research on
various algorithms, implementing the solution and then breaking your own
solution.</p>

<h2>Why do I want to do this?</h2>

<p>I found it as a good opportunity to sharpen my C++ programming skills
and learn more about cryptographical theory and it's applications. If
you're curious and passionate enough to solve puzzles, this is your
chance!</p>

<h2>What's next?</h2>

<p>I will be posting walkthroughs (on how I solved every problem in each
set) on my blog and also provide solutions to those problems on my
<a href="https://www.github.com/megacolorboy">GitHub</a> repository.</p>

<p>Stay tuned!</p>

	</div>
	<div class="article-footer">
		<time>November 11th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/new-feature-share-your-reaction">New feature: Share your reaction</a></h1>
		<p class="description">Rolled out a new feature to collect emotional intelligence, which would help me to make better blog posts in the future.</p>
	</div>
	<div class="article-body">
		<p>Last night, I was thinking on how to improve my blog posts and post better articles. My head went through questions like:</p>

<ul>
<li>What do people feel when they read my articles?</li>
<li>Do they find it interesting?</li>
<li>Is it boring?</li>
<li>Is it likeable?</li>
</ul>

<p>But, in order to do that, I'll require some simple analytics on how people react to my articles on my blog. Taking inspiration from web applications like Facebook, Instagram, Twitter and Medium, I decided to build a small feature named "Share your reaction", from scratch, that would contain six different emotions.</p>

<figure style="text-align: center;">
    <div>
        <img style="width: 32px; height:32px; display: inline-block; margin-left: 10px; margin-right: 10px;" src="/static/images/new_emojis/like.png"> 
        <img style="width: 32px; height:32px; display: inline-block; margin-left: 10px; margin-right: 10px;" src="/static/images/new_emojis/love.png"> 
        <img style="width: 32px; height:32px; display: inline-block; margin-left: 10px; margin-right: 10px;" src="/static/images/new_emojis/haha.png"> 
        <img style="width: 32px; height:32px; display: inline-block; margin-left: 10px; margin-right: 10px;" src="/static/images/new_emojis/wow.png"> 
        <img style="width: 32px; height:32px; display: inline-block; margin-left: 10px; margin-right: 10px;" src="/static/images/new_emojis/sad.png"> 
        <img style="width: 32px; height:32px; display: inline-block; margin-left: 10px; margin-right: 10px;" src="/static/images/new_emojis/angry.png">
    </div>
    <figcaption>The six different emotions used in this new feature</figcaption>
</figure>

<p>From today onwards, you can start reacting to my blog posts by clicking the <strong><em>"React!"</em></strong> button (which can be found below every article), select an emotion and help me improve and post better articles in my blog in the future.</p>

<p>In case, you're wondering, the data that is collected is <strong><em>completely anonymous</em></strong> as I'm not collecting any IP address or any of your private and sensitive information.</p>

<p>Hope you guys like the new feature!</p>

	</div>
	<div class="article-footer">
		<time>October 14th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/update/">
					Update
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
			</div>
			
<div class="pagination">
	
		
		<a href="/pages/24">&laquo;</a>
			
	

	
		
			<a class="" href="/">1</a>
		
	
		
			<a class="" href="/pages/22">...</a>
		
	
		
			<a class="" href="/pages/23">23</a>
		
	
		
			<a class="" href="/pages/24">24</a>
		
	
		
			<a class="active" href="/pages/25">25</a>
		
	
		
			<a class="" href="/pages/26">26</a>
		
	

	
		<a href="/pages/26">&raquo;</a>
	
</div>

		</section>
		<!-- 
			Contains blog links that I follow 
			Bookmarks
			Interesting quotes/content
		-->
		<section id="secondary">
			<div class="sidebar">
				<div class="author-intro">
	<h3>Hello, I'm Abdush Shakoor! &#x1F44B;</h3>
	<p>I'm a programmer & designer based in Dubai, United Arab Emirates. I love tinkering with code and writing about what I learn.</p>
	<p>This website is my digital garden &mdash; a compendium of the things I've learned and created over the years.</p>

	<ul class="sitemap">
		<li><a href="mailto:megacolorboy@gmail.com">Email</a></li>
		<li><a href="https://github.com/megacolorboy">GitHub</a></li>
		<li><a href="https://linkedin.com/in/abdush-shakoor-mohamed-nazeer-b5546546">LinkedIn</a></li>
		<li><a href="https://twitter.com/MegaColorBoy">Twitter</a></li>
	</ul>
</div>
				<!-- Tags -->
<div>
	<h3>Categories</h3>
	<ul class="tags">
		
		<li>
			<a href="/category/linux/">
				Linux
				<span class="count">22</span>
			</a>
		</li>
		
		<li>
			<a href="/category/laravel/">
				Laravel
				<span class="count">17</span>
			</a>
		</li>
		
		<li>
			<a href="/category/devops/">
				DevOps
				<span class="count">14</span>
			</a>
		</li>
		
		<li>
			<a href="/category/php/">
				PHP
				<span class="count">11</span>
			</a>
		</li>
		
		<li>
			<a href="/category/javascript/">
				JavaScript
				<span class="count">11</span>
			</a>
		</li>
		
		<li>
			<a href="/category/terminal/">
				Terminal
				<span class="count">11</span>
			</a>
		</li>
		
		<li>
			<a href="/category/algorithms/">
				Algorithms
				<span class="count">11</span>
			</a>
		</li>
		
		<li>
			<a href="/category/cryptography/">
				Cryptography
				<span class="count">11</span>
			</a>
		</li>
		
		<li>
			<a href="/category/git/">
				Git
				<span class="count">10</span>
			</a>
		</li>
		
		<li>
			<a href="/category/programming/">
				Programming
				<span class="count">9</span>
			</a>
		</li>
		
		<li>
			<a href="/category/productivity/">
				Productivity
				<span class="count">8</span>
			</a>
		</li>
		
		<li>
			<a href="/category/vim/">
				VIM
				<span class="count">8</span>
			</a>
		</li>
		
		<li>
			<a href="/category/unix/">
				UNIX
				<span class="count">8</span>
			</a>
		</li>
		
		<li>
			<a href="/category/tutorial/">
				Tutorial
				<span class="count">6</span>
			</a>
		</li>
		
		<li>
			<a href="/category/update/">
				Update
				<span class="count">6</span>
			</a>
		</li>
		
		<li>
			<a href="/category/mysql/">
				MySQL
				<span class="count">6</span>
			</a>
		</li>
		
		<li>
			<a href="/category/essay/">
				Essay
				<span class="count">6</span>
			</a>
		</li>
		
		<li>
			<a href="/category/blogmarks/">
				Blogmarks
				<span class="count">5</span>
			</a>
		</li>
		
		<li>
			<a href="/category/apache/">
				Apache
				<span class="count">5</span>
			</a>
		</li>
		
		<li>
			<a href="/category/personal-challenge/">
				Personal Challenge
				<span class="count">5</span>
			</a>
		</li>
		
		<li>
			<a href="/category/arcade-challenge/">
				Arcade Challenge
				<span class="count">4</span>
			</a>
		</li>
		
		<li>
			<a href="/category/python/">
				Python
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/regular-expressions/">
				Regular Expressions
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/data-structures/">
				Data Structures
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/user-interface/">
				User Interface
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/user-experience/">
				User Experience
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/general/">
				General
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/docker/">
				Docker
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/aws/">
				AWS
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/generative-art/">
				Generative Art
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/css/">
				CSS
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/wget/">
				wget
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/vscode/">
				VSCode
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/email/">
				Email
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/bash/">
				Bash
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/wamp/">
				WAMP
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/image-manipulation/">
				Image Manipulation
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/travel/">
				Travel
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/tech/">
				Tech
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/learning/">
				Learning
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/ubuntu/">
				Ubuntu
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/ssh/">
				SSH
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/databases/">
				Databases
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/tooling/">
				Tooling
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/graphics/">
				Graphics
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/selfreflection/">
				Self-reflection
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/security/">
				Security
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/cpanel/">
				cPanel
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/introduction/">
				Introduction
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/refactoring/">
				Refactoring
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/scss/">
				SCSS
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/xfce/">
				XFCE
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/chrome-devtools/">
				Chrome DevTools
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/go/">
				Go
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/ssl/">
				SSL
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/jquery/">
				jQuery
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/art/">
				Art
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/tips/">
				Tips
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/review/">
				Review
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/artificial-intelligence/">
				Artificial Intelligence
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/mathematics/">
				Mathematics
				<span class="count">1</span>
			</a>
		</li>
		
	</ul>
</div>
<!-- Tags -->
			</div>
		</section>
	</div>
</main>

<footer>
    <span class="copyright">&copy; Abdush Shakoor</span>
</footer>

<script src="/static/vendor/jquery/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

<script src="/static/js/art.js"></script>

<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script defer id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-98290003-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-98290003-2');
</script>
<script src="/static/vendor/jquery-lazy/jquery.lazy.min.js"></script>
<script>
  $(function () {
    $('.lazy').lazy();
  });
</script>
<!-- <script>
    const darkModeButton = document.createElement('button');
    const syntaxHighlightSource = document.getElementById('syntaxHighlight');
    const menuList = document.querySelector('.menu');
    const themeSettings = {
        "dark": {
            "icon": '<i class="ph-moon-fill"></i>',
            "hljs": "/static/vendor/hljs/css/github-dark.css",
        },
        "light": {
            "icon": '<i class="ph-sun-fill"></i>',
            "hljs": "/static/vendor/hljs/css/github.min.css",
        },
    }

    function highlightMenuLink() {
        var currentURI = window.location.href;
        currentURI = currentURI.replace(window.location.protocol + "//", "");
        var currentPage	 = currentURI.split('/')[1];

        if(currentPage) {
            $('a[href="/' + currentPage + '"').parent().addClass('active');
        }
    }
    
    function initThemeSwitcher() {
        darkModeButton.innerHTML = themeSettings.light.icon;
        darkModeButton.classList.add('darkModeButton');
        
        darkModeButton.addEventListener('click', function(){
            switch(document.documentElement.getAttribute('data-theme')) {
                case 'dark':
                    lightMode();
                    break;

                case 'light':
                default:
                    darkMode();
                    break;
            }
        });
        
        var newItem = document.createElement('li');
        newItem.appendChild(darkModeButton);
        menuList.insertBefore(newItem, menuList.childNodes[menuList.childNodes - 1]);
    }
    

    // Settings for dark mode
    function darkMode() {
        darkModeButton.innerHTML = themeSettings.dark.icon;
        document.documentElement.setAttribute('data-theme', 'dark');
        syntaxHighlightSource.setAttribute('href', themeSettings.dark.hljs);
        localStorage.setItem("theme", "dark");
    }

    // Settings for light mode
    function lightMode() {
        darkModeButton.innerHTML = themeSettings.light.icon;
        document.documentElement.setAttribute('data-theme', '');
        syntaxHighlightSource.setAttribute('href', themeSettings.light.hljs);
        localStorage.setItem("theme", "");
    }

    function checkTheme() {
        const localStorageTheme = localStorage.getItem("theme");
        switch(localStorageTheme) {
            case "dark":
                darkMode();
                break;
            
            default:
                lightMode();
                break;
        }
    }

    // Check if the theme is stored in session
    window.onload = function() {
        initThemeSwitcher();
        checkTheme();
        highlightMenuLink();
    }

    //  open and close nav 
    $('#navbar-toggle').click(function() {
      $('nav ul').slideToggle();
    });

    // Hamburger toggle
    $('#navbar-toggle').on('click', function() {
      this.classList.toggle('active');
    });

    // Click outside the dropdown will remove the dropdown class
    $('html').click(function() {
      $('.navbar-dropdown').hide();
    });
</script> -->
</body>
</html>