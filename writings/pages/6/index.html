<!DOCTYPE html>
<html data-theme="" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Abdush Shakoor">
	
	<meta name="description" content="Sometimes, I write stuff about computers, math, technology & design..">
	<meta name="og:title" content="Writings | Abdush Shakoor's Weblog" />
	<meta name="og:type" content="article" />
	<meta name="og:url" content="" />
	<meta name="og:description" content="Sometimes, I write stuff about computers, math, technology & design." />
	<meta name="og:site_name" content="Abdush Shakoor's Weblog | Abdush Shakoor's Weblog" />
	
	<meta name="robots" content="follow">
	<title>Writings | Abdush Shakoor's Weblog </title>
	<link rel="stylesheet" href="/static/css/main.css" type="text/css">
	<link rel="stylesheet" href="/static/css/pygments.css" type="text/css">

	<link rel="apple-touch-icon" sizes="57x57" href="/static/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/static/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/static/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/static/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/static/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/static/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/static/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/static/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/static/favicon/png" sizes="192x192"  href="/static/favicon/android-icon-192x192.png">
<link rel="icon" type="image/static/favicon/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
<link rel="icon" type="image/static/favicon/png" sizes="96x96" href="/static/favicon/favicon-96x96.png">
<link rel="icon" type="image/static/favicon/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
<link rel="manifest" href="/static/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
	
	<!-- <script src="https://unpkg.com/phosphor-icons"></script> -->
	<!-- <script>
		if(localStorage.theme){
			document.documentElement.setAttribute('data-theme', localStorage.getItem("theme"));
		}
	</script> -->
</head>
<body class="">
	<!-- Navbar -->
	<header class="header">
	<!-- Logo with Author Name -->
	<div class="author">
		<a href="/">
			<img src="/static/logo.png" alt="megacolorboy">
			<div class="name">
				<h1>Abdush Shakoor's Weblog</h1>
				<p>Writings, experiments & ideas.</p>
			</div>
		</a>
	</div>
	<!-- Logo with Author Name -->
	<nav>
		<ul class="menu">
			
				<li><a href="/about">About</a></li>
			
				<li><a href="/archive">Archive</a></li>
			
		</ul>
	</nav>	
</header>

<main>
	<div class="two-col-grid">
		<section id="primary">
			<div class="articles">
				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/convert-svg-from-image-to-code-using-javascript">Convert SVG from Image to Code using Javascript</a></h1>
		<p class="description">Two weeks ago, I wrote a small script to convert SVG from Image to Code using Javascript that allowed me to play around with it's attributes and properties.</p>
	</div>
	<div class="article-body">
		<p>Have you ever downloaded minimal and beautiful looking SVG icons and
added them into your HTML code as an <strong><em>&lt;img&gt;</em></strong> instead of
<strong><em>&lt;svg&gt;</em></strong> tag? The answer is: <strong><em>"yes, you're right!"</em></strong>.</p>

<p>Okay, how about another question?</p>

<p>What would you do if you want to change all of those SVG icons to black,
red or blue? Your answer would be: <strong><em>"Well, I would edit the colors of
all the vector images in Adobe Illustrator and then refresh my page to
see the changes."</em></strong>, if that's your answer, then what would you do if
you have to do it for multiple icons in multiple pages in a short amount
of time?</p>

<p>Two weeks ago, I faced this same scenario and I found a quick solution
to it and I will be sharing it in this article on how to convert SVG
from image to code using Javascript and how it allowed me to play around
with attributes and properties.</p>

<h2>Why convert from Image to Code?</h2>

<p>Well, as a developer, it allows me to interact with every part of the
SVG such as changing the colors, adjusting the height and width, animate
it and so on. In this article, I will show you an example on how I could
do a simple color change on an SVG image that I had downloaded from
<a href="https://www.flaticon.com">flaticon</a>.</p>

<figure>
    <img src="/static/images/space.svg"/>
    <figcaption>
        Figure 1. Original SVG Space Icon
    </figcaption>
</figure>

<h2>How to convert from Image to Code?</h2>

<p>Simple, just convert the SVG image into an XML format using
<strong><em>XMLSerializer()</em></strong> then give it a class name like <strong><em>"custom-svg-icon"</em></strong>
and execute the code! Below, I have provided a code snippet, I hope the
comments will help you out!</p>

<p><strong>Code snippet:</strong>
    <div class="codehilite"><pre><span></span><code><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
     <span class="c1">//Change the class name, if it has to be applied for more SVG elements</span>
     <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;img.custom-svg-icon&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
     <span class="kd">var</span> <span class="nx">$img</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// The image</span>
     <span class="kd">var</span> <span class="nx">imgID</span> <span class="o">=</span> <span class="nx">$img</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span> <span class="c1">// ID attribute</span>
     <span class="kd">var</span> <span class="nx">imgClass</span> <span class="o">=</span> <span class="nx">$img</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">);</span> <span class="c1">// Class Name</span>
     <span class="kd">var</span> <span class="nx">imgURL</span> <span class="o">=</span> <span class="nx">$img</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">);</span> <span class="c1">// URL of the SVG image</span>
 <br />
     <span class="nx">jQuery</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">imgURL</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">//The data param contains the XML data of the SVG image</span>
     <span class="c1">//alert(new XMLSerializer().serializeToString(data));</span>
 <br />
     <span class="c1">// Get the SVG tag, ignore the rest</span>
     <span class="kd">var</span> <span class="nx">$svg</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="nx">data</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">);</span>
 <br />
     <span class="c1">// Give the image&#39;s ID to the SVG</span>
     <span class="k">if</span><span class="p">(</span><span class="ow">typeof</span> <span class="nx">imgID</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> 
     <span class="p">{</span>
     <span class="nx">$svg</span> <span class="o">=</span> <span class="nx">$svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nx">imgID</span><span class="p">);</span>
     <span class="p">}</span>
 <br />
     <span class="c1">// Give the image&#39;s class to the SVG</span>
     <span class="k">if</span><span class="p">(</span><span class="ow">typeof</span> <span class="nx">imgClass</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> 
     <span class="p">{</span>
     <span class="nx">$svg</span> <span class="o">=</span> <span class="nx">$svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="nx">imgClass</span><span class="o">+</span><span class="s1">&#39; replaced-svg&#39;</span><span class="p">);</span>
     <span class="p">}</span>
 <br />
     <span class="c1">// Remove any invalid XML tags as per http://validator.w3.org</span>
     <span class="nx">$svg</span> <span class="o">=</span> <span class="nx">$svg</span><span class="p">.</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s1">&#39;xmlns:a&#39;</span><span class="p">);</span>
 <br />
     <span class="c1">// Check if the viewport is set, else we gonna set it if we can.</span>
     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">$svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;viewBox&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">$svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">$svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">))</span> 
     <span class="p">{</span>
     <span class="nx">$svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;viewBox&#39;</span><span class="p">,</span> <span class="s1">&#39;0 0 &#39;</span> <span class="o">+</span> <span class="nx">$svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">$svg</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">))</span>
     <span class="p">}</span>
 <br />
     <span class="c1">// Replace image with new SVG</span>
     <span class="nx">$img</span><span class="p">.</span><span class="nx">replaceWith</span><span class="p">(</span><span class="nx">$svg</span><span class="p">);</span>
 <br />
     <span class="p">},</span> <span class="s1">&#39;xml&#39;</span><span class="p">);</span> <span class="c1">//Returns as XML</span>
     <span class="p">});</span>
    <span class="p">});</span>
    </code></pre></div></p>

<p>Give it some custom CSS to change the color and width of the SVG image:
    <div class="codehilite"><pre><span></span><code><span class="nt">svg</span><span class="w"> </span><span class="nt">path</span><span class="o">,</span><span class="w"> </span><span class="nt">svg</span><span class="w"> </span><span class="nt">rect</span><span class="w"></span>
    <span class="p">{</span><span class="w"></span>
    <span class="w">    </span><span class="n">fill</span><span class="p">:</span><span class="w"> </span><span class="mh">#ff5a5f</span><span class="p">;</span><span class="w"></span>
    <span class="p">}</span><span class="w"></span>
 <br />
    <span class="p">.</span><span class="nc">custom-svg-icon</span><span class="w"></span>
    <span class="p">{</span><span class="w"></span>
    <span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">170</span><span class="kt">px</span><span class="p">;</span><span class="w"></span>
    <span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">170</span><span class="kt">px</span><span class="p">;</span><span class="w"></span>
    <span class="p">}</span><span class="w"></span>
    </code></pre></div></p>

<p>Right-click on the image, hit <strong><em>"Inspect Element"</em></strong> and view the
converted image below but this time, you'll see it as an SVG element:</p>

<script defer src="/static/projects/svg-img-to-code/script.js"></script>

<figure>
    <img class="custom-svg-icon" src="/static/images/space.svg"/>
    <figcaption>
        Figure 2. Converted SVG Space Icon
    </figcaption>
</figure>

<p>However, there are a few downsides to this as SVG code is hard to
maintain, pretty messy and sometimes quite complex especially if it
contains a lot of paths, circles and rectangles but in a scenario that
is similar to what I have faced, I think it's pretty useful, otherwise,
just stick to adding your SVG images using the <strong><em>&lt;img&gt;</em></strong> tag.</p>

<p>Hope you have found this article useful!</p>

<h2>Credit</h2>

<p>Icons made by <a href="https://www.flaticon.com/authors/eucalyp">Eucalyp</a> from <a href="https://www.flaticon.com/">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/">CC 3.0
BY</a></p>

	</div>
	<div class="article-footer">
		<time>February 24th, 2018</time>
		<ul class="tags">
			
			<li>
				<a href="/category/programming/">
					Programming
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/i-decided-to-learn-python">I decided to learn Python</a></h1>
		<p class="description">I decided to get back on solving algorithmic and programming puzzles by adding a new programming language to my tech arsenal, Python.</p>
	</div>
	<div class="article-body">
		<p>Hello Folks!</p>

<p>Happy New Year! I know I'm late at this point but hey, it's better late
than never!</p>

<p>As the year had begun, I got busy with work and I barely found any time
to post anything new but that doesn't mean I didn't do anything new.</p>

<p>At the end of December, I decided to get back on solving algorithmic and
programming puzzles again (The last time I did was back on 2016) and for
starters, I decided to solve <a href="http://projecteuler.net">Project Euler</a>
problems by adding a new programming language to my tech arsenal,
<strong><em>Python</em></strong>.</p>

<h2>Why solve it using Python?</h2>

<p>Previously, I'd solved around 57 problems using <strong><em>C++</em></strong> and it got
paused for a while after I got into internships and work life. But now
that I have found the time for it, I thought that this would be the
perfect opportunity for me to learn Python. It has a really good
community, good documentation and the code looks so clean, simple and
readable without those curly brackets!</p>

<h2>What is Project Euler?</h2>

<p>It's a website that hosts a series of challenging algorithmic and
mathematical programming puzzles in which you will have to produce
solutions that'd <strong><em>clock in under a minute</em></strong> with decent computer
specifications.</p>

<p>By solving these puzzles, you will be experiencing an <strong><em>inductive chain
learning</em></strong> i.e. when you solve one problem, you'll be exposed to a
completely new concept that allows you to delve into unfamiliar areas of
mathematics and programming.</p>

<p>As I'm writing this article, I'm taking it slow and I have solved around
21 problems in 3 weekends. I will be posting a walkthrough for each
problem but for now, I will talk about one of my favorite problems:
<strong><em>Maximum Path Sum</em></strong>.</p>

<h2>Maximum Path Sum</h2>

<p>Problem definition of <a href="https://projecteuler.net/problem=18">Problem 18</a>:</p>

<p>By starting at the top of the Binary Tree below and moving to adjacent
numbers on the row below, the maximum total from top to bottom is 23.</p>

<p style="text-align:center;font-family:'FiraMono';font-size:12pt;"><span style="color:#ff0000;"><b>3</b></span><br><span style="color:#ff0000;"><b>7</b></span> 4<br>
2 <span style="color:#ff0000;"><b>4</b></span> 6<br>
8 5 <span style="color:#ff0000;"><b>9</b></span> 3</p>

That is, 3 + 7 + 4 + 9 = 23. Now, find the maximum total from top to bottom of the Binary Tree below:

<p style="text-align:center;font-family:'FiraMono';">
75<br>
95 64<br>
17 47 82<br>
18 35 87 10<br>
20 04 82 47 65<br>
19 01 23 75 03 34<br>
88 02 77 73 07 63 67<br>
99 65 04 28 06 16 70 92<br>
41 41 26 56 83 40 80 70 33<br>
41 48 72 33 47 32 37 16 94 29<br>
53 71 44 65 25 43 91 52 97 51 14<br>
70 11 33 28 77 73 17 78 39 68 17 57<br>
91 71 52 38 17 14 91 43 58 50 27 29 48<br>
63 66 04 68 89 53 67 30 73 16 69 87 40 31<br>
04 62 98 27 23 09 70 98 73 93 38 53 60 04 23
</p>

<p>Since there are fifteen rows, you can solve this puzzle using Brute
Force by trying every route possible but if you're going to use that
same technique for <a href="https://projecteuler.net/problem=67">Problem 67</a>
that has a Binary Tree containing one hundred rows, it will not be
efficient. So this problem forces you to avoid brute force and instead
wants you to come up with a clever solution!</p>

<h2>Solution</h2>

<p>As I had mentioned above, a brute force technique is going to be very
inefficient, instead I did a bottom-up approach:</p>

<p><strong>Implementation of the method(s):</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1"># Sum of numbers</span>
<span class="k">def</span> <span class="nf">sumOfNumbers</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>

<span class="c1"># Return the maximum path sum in a Binary Tree</span>
<span class="c1"># Bottom Up Approach</span>
<span class="k">def</span> <span class="nf">maxPathSum</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="c1"># the last number of the list</span>
    <span class="n">last</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="c1"># number of rows in the Binary Tree</span>
    <span class="n">nrow</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># count the number of rows in the Binary Tree</span>
    <span class="c1"># use the sum of numbers method to count the number of rows</span>
    <span class="k">while</span> <span class="n">sumOfNumbers</span><span class="p">(</span><span class="n">nrow</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">last</span><span class="p">:</span>
        <span class="c1"># print (sumOfNumbers(nrow))</span>
        <span class="n">nrow</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">last</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># print list[last - i]</span>

        <span class="c1"># iterate through each number in each row</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="c1"># pick a number from the row above the current row</span>
            <span class="c1"># and pick the 2 numbers from the current row</span>
            <span class="c1"># Find the max between the two numbers and add it</span>
            <span class="nb">list</span><span class="p">[</span><span class="n">last</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="n">last</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">last</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">last</span><span class="p">])</span>

            <span class="c1"># shift to the next number in the row above</span>
            <span class="n">last</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="c1"># shift to the next number in the row above</span>
        <span class="n">last</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="c1"># return the max sum</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

<p><strong>Final code:</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1"># Project Euler: Problem 18 and 67 - Maximum Path Sum I and II</span>

<span class="c1">#!usr/bin/python</span>
<span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">pe_lib</span>

<span class="n">num_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="c1"># read text file</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;triangle2.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">num_str</span> <span class="o">+=</span> <span class="n">line</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># convert the string numbers to integers in the list</span>
<span class="nb">list</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">num_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span> <span class="n">pe_lib</span><span class="o">.</span><span class="n">maxPathSum</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Finished: </span><span class="si">%f</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</code></pre></div>

<p>The maximum path sum for <strong><em>Problem 67</em></strong> is <strong><em>7273</em></strong> and it compiled in
<strong><em>0.003990</em></strong> seconds.</p>

<p><strong><em>Note: This solution and the library named <mark>pe_lib.py</mark> was
built using the Python programming language. The source code for this
solution can be found on Github.</em></strong></p>

<p>Stay tuned for more!</p>

	</div>
	<div class="article-footer">
		<time>February 3rd, 2018</time>
		<ul class="tags">
			
			<li>
				<a href="/category/algorithms/">
					Algorithms
				</a>
			</li>
			
			<li>
				<a href="/category/programming/">
					Programming
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--detect-aes-in-ecb-mode">The Cryptopals Crypto Challenges: Set 1 - Detect AES in ECB Mode</a></h1>
		<p class="description">Find the string that has been encrypted with AES-128 cipher with an ECB mode in a file of ciphertexts.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/8">eighth challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided walkthroughs for the previous challenges, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encoding-decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-single-byte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-detect-single-character-xor">The Cryptopals Crypto Challenges: Set 1 - Detect Single-Character XOR</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-implement-repeating-key-xor">The Cryptopals Crypto Challenges: Set 1 - Implement Repeating-Key XOR</a></li>
<li><a href="/posts/hamming-distance-algorithm-in-c">Hamming Distance Algorithm in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-break-repeating-key-xor">The Cryptopals Crypto Challenges: Set 1 - Break Repeating-Key XOR</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-aes-in-ecb-mode">The Cryptopals Crypto Challenges: Set 1 - AES in ECB Mode</a></li>
</ul>

<p>For this challenge, you are given a <a href="http://cryptopals.com/static/challenge-data/8.txt">file</a>, which contains a bunch of ciphertexts that has been encrypted using <strong><em>AES-128 Cipher</em></strong> but only one of them has an <strong><em>ECB (Electronic Codebook)</em></strong> mode. Find the string the string that has the ECB mode.</p>

<p>In the <a href="/posts/the-cryptopals-crypto-challenges-set-1-aes-in-ecb-mode">previous post</a>, I had explained that <strong><em>ECB</em></strong> is a cipher mode that is used to repeat the key until it covers the entire plaintext i.e. the same 16 byte plaintext will have the same 16 byte ciphertext.</p>

<p>Well, the solution is pretty much trivial, so here's the solution:</p>

<p><strong>Implementation of the method(s):</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1">//Detect ECB Mode in AES Cipher</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">CryptoLib::detect_ecb_mode</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">keyLength</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//Divide into equal amount of blocks</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">keyLength</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        Theory: the problem with ECB as I had mentioned</span>
<span class="cm">        in the previous post, it uses the exact number of bytes of the ciphertext</span>
<span class="cm">        to encrypt the plaintext repeatedly.</span>

<span class="cm">        In that case, just do the reverse.</span>

<span class="cm">        Divide it into equal amount of blocks, in this case, we</span>
<span class="cm">        know the key is &quot;YELLOW SUBMARINE&quot;, which is 16 bytes.</span>

<span class="cm">        Then, all you have to do is take two substrings of a string and compare,</span>
<span class="cm">        if they have the same string, we found it!</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">blocks</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//Take a substring of x number of bytes</span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">strA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">keyLength</span><span class="p">,</span><span class="w"> </span><span class="n">keyLength</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">blocks</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">//Take another substring of x number of bytes</span>
<span class="w">            </span><span class="n">string</span><span class="w"> </span><span class="n">strB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">keyLength</span><span class="p">,</span><span class="w"> </span><span class="n">keyLength</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">strA</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">strB</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="c1">//Found</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong>Final code:</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1">//The Cryptopals Crypto Challenges - Set 1 Challenge 8</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">ifstream</span><span class="w"> </span><span class="n">infile</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">infile</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;8.txt&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">infile</span><span class="p">.</span><span class="n">eof</span><span class="p">())</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">getline</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Check if this string has ECB mode</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">crypt</span><span class="p">.</span><span class="n">detect_ecb_mode</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;FOUND AT LINE &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; =&gt; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong><em>Note: This solution and the library named <mark>crypto.h</mark> was
built using the C++ programming language. The source code for this
solution can be found on Github.</em></strong></p>

<p>Well, this challenge marks the end of Set 1 from The Cryptopals Crypto
Challenges. However, I do intend to continue solving all these crypto
challenges, let's see how it goes!</p>

<p>Until next time, then!</p>

	</div>
	<div class="article-footer">
		<time>December 29th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1---aes-in-ecb-mode">The Cryptopals Crypto Challenges: Set 1 -  AES in ECB Mode</a></h1>
		<p class="description">Decrypt a Base64 encoded file that is encrypted with an AES-128 Cipher in ECB mode.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/7">seventh challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided walkthroughs for the previous challenges, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encoding-decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-single-byte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-detect-single-character-xor">The Cryptopals Crypto Challenges: Set 1 - Detect Single-Character XOR</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-implement-repeating-key-xor">The Cryptopals Crypto Challenges: Set 1 - Implement Repeating-Key XOR</a></li>
<li><a href="/posts/hamming-distance-algorithm-in-c">Hamming Distance Algorithm in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-break-repeating-key-xor">The Cryptopals Crypto Challenges: Set 1 - Break Repeating-Key XOR</a></li>
</ul>

<p>For this challenge, you are given a <a href="http://cryptopals.com/static/challenge-data/7.txt">file</a>, which contains a ciphertext that has been encrypted using <strong><em>AES-128 Cipher</em></strong> with <strong><em>ECB (Electronic Codebook)</em></strong> mode and then encoded using Base64. Decrypt it.</p>

<p>In order to decrypt it, you are given a key:</p>

<div class="codehilite"><pre><span></span><code>YELLOW SUBMARINE
</code></pre></div>

<h2>What is AES?</h2>

<p><a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">Advanced Encryption Standard</a> a.k.a <strong><em>Rjindael</em></strong>, which was developed by two belgian cryptographers, <a href="https://en.wikipedia.org/wiki/Vincent_Rijmen">Vincent Rijmen</a> and <a href="https://en.wikipedia.org/wiki/Joan_Daemen">Joan Daemen</a>. <strong><em>Rjindael</em></strong> is a family of ciphers with various block and key sizes.</p>

<p><strong><em>AES-128</em></strong> is commonly used but there are also larger key sizes such as <strong><em>192</em></strong> and <strong><em>256</em></strong> bits. Similar to <strong><em>XOR cipher</em></strong>, it uses the same key to encrypt and decrypt the message. Till date, there isn't any publication that states if whether <strong><em>AES</em></strong> is broken but even if you were to break it, it will take atleast a <strong><em>billion years</em></strong> with a supercomputer, which could beyond the age of the universe.</p>

<h2>What is ECB Mode?</h2>

<p>What if your plaintext is longer than (in this case, 128 bits) the keysize? This is where <strong><em>ECB</em></strong> comes into the picture. <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">ECB (Electronic Codebook)</a> is a cipher mode that is used to repeat the key until it covers the entire plaintext (similar to <a href="/posts/the-cryptopals-crypto-challenges-set-1-implement-repeating-key-xor">Repeating-Key XOR Cipher</a>) and then each <strong><em>block</em></strong> is independently encrypted using the <strong><em>AES</em></strong> algorithm to produce the desired ciphertext.</p>

<p>This challenge is not that hard, in fact, it's completely trivial and more like an introduction of <strong><em>AES Cipher</em></strong>. There are so many ways to solve this problem but I chose to solve this problem using <strong><em>OpenSSL</em></strong> and other commandline tools such as <strong><em>xxd</em></strong> (used to print the hexdump of a file) on my UNIX terminal.</p>

<p>Here's the solution:</p>

<div class="codehilite"><pre><span></span><code>openssl enc -aes-128-ecb -d -a -in secret.txt -K <span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;YELLOW SUBMARINE&quot;</span> <span class="p">|</span> xxd -p<span class="k">)</span> -iv <span class="m">1</span> <span class="p">|</span> head
</code></pre></div>

<p>This is the decrypted message:</p>

<div class="codehilite"><pre><span></span><code>I&#39;m back and I&#39;m ringin&#39; the bell
A rockin&#39; on the mike while the fly girls yell
In ecstasy in the back of me
Well that&#39;s my DJ Deshay cuttin&#39; all them Z&#39;s
Hittin&#39; hard and the girlies goin&#39; crazy
Vanilla&#39;s on the mike, man I&#39;m not lazy.

I&#39;m lettin&#39; my drug kick in
It controls my mouth and I begin
To just let it flow, let my concepts go
</code></pre></div>

<p>Initially, I was planning to write an implementation of <strong><em>AES</em></strong> for fun, but then I decided to make it a side project that I can work on as there are a lot of things about <strong><em>AES</em></strong> that I'd like to talk about in the future.</p>

<p>Stay tuned for the next challenge!</p>

	</div>
	<div class="article-footer">
		<time>December 21st, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/hamming-distance-algorithm-in-c">Hamming Distance Algorithm in C++</a></h1>
		<p class="description">An article about the Hamming Distance algorithm that will be used in the next challenge.</p>
	</div>
	<div class="article-body">
		<p>This is a short article about the <strong><em>Hamming Distance</em></strong> algorithm, which will be used in The Cryptopals Crypto Challenges: Set 1 - Break Repeating-Key XOR challenge.</p>

<p>In <a href="http://cryptopals.com/sets/1/challenges/6">Challenge 6</a>, the first step states that you have to write a function to compute the <strong><em>edit distance/Hamming distance</em></strong> between two strings:</p>

<div class="codehilite"><pre><span></span><code>this is a test
</code></pre></div>

<p>And</p>

<div class="codehilite"><pre><span></span><code>wokka wokka!!!
</code></pre></div>

<p>When this function is executed, the expected result must be <strong><em>37</em></strong>. If you we're able to make this function work, you can proceed with the next steps in the challenge.</p>

<h2>What is Hamming Distance?</h2>

<p>Applied in domains like Cryptography, Information theory and Coding theory, Hamming distance is just the number of differing bits between two strings of equal length. Named after the American Mathematician, <a href="https://en.wikipedia.org/wiki/Richard_Hamming">Richard Hamming</a>, this algorithm mainly used for Error Detection and Error Correction (and yes, this also makes use of <a href="/posts/base64-encoding-decoding-using-bitwise-manipulation-in-c">Bitwise Operators</a>).</p>

<p>Using the example above, let's see how this works, in theory:</p>

<div class="codehilite"><pre><span></span><code>ASCII Format: this is a test
Binary Format: 011101[0][0] 01101[0][0][0] 011010[0]1 011[1][0]011 0[0]10000[0] 0[1]10[1]00[1] 01110[0]11 0[0]10[0][0][0][0] 0110[0]0[0]1 0[0]10[0]0[0][0] 011[1]0[1]0[0] 0[1]100[1]01 0[1]1[1]00[1]1 0[1]1[1]0[1]0[0]

ASCII Format: wokka wokka!!!
Binary Format: 011101[1][1] 01101[1][1][1] 011010[1]1 011[0][1]011 0[1]10000[1] 0[0]10[0]00[0] 01110[1]11 0[1]10[1][1][1][1] 0110[1]0[1]1 0[1]10[1]0[1][1] 011[0]0[0]0[1] 0[0]100[0]01 0[0]1[0]00[0]1 0[0]1[0]0[0]0[1]
</code></pre></div>

<p>As per the given example, when you count the number of differing bits (the bits marked in brackets) between the two strings, the result is <strong><em>37</em></strong>.</p>

<p>With help of <strong><em>Google</em></strong> and <strong><em>Wikipedia</em></strong>, I was able to build an implementation of this algorithm using the C++ programming language:</p>

<div class="codehilite"><pre><span></span><code><span class="c1">//Hamming Distance</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">CryptoLib::hamming_distance</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str1</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str1</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">partial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">str1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">str2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">partial</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">partial</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">partial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">partial</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Hope you found this article useful!</p>

<p>Adios Amigo!</p>

	</div>
	<div class="article-footer">
		<time>December 18th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/algorithms/">
					Algorithms
				</a>
			</li>
			
			<li>
				<a href="/category/programming/">
					Programming
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--break-repeatingkey-xor">The Cryptopals Crypto Challenges: Set 1 - Break Repeating-Key XOR</a></h1>
		<p class="description">Write a method that decodes a message which is encrypted using the Repeating-Key XOR cipher.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/6">sixth challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided walkthroughs for the previous challenges, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encodingdecoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--detect-singlecharacter-xor">The Cryptopals Crypto Challenges: Set 1 - Detect Single-Character XOR</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--implement-repeatingkey-xor">The Cryptopals Crypto Challenges: Set 1 - Implement Repeating-Key XOR</a></li>
<li><a href="/posts/hamming-distance-algorithm-in-c">Hamming Distance Algorithm in C++</a></li>
</ul>

<p>For this challenge, you are given a <a href="http://cryptopals.com/static/challenge-data/6.txt">file</a>, which contains a ciphertext that has been encrypted using <a href="/posts/the-cryptopals-crypto-challenges-set-1--implement-repeatingkey-xor">Repeating-Key XOR</a> and then encoded using Base64. Decrypt it.</p>

<p>According to the problem description on the website:</p>

<blockquote>
  <p>It is officially on, now.</p>
  
  <p>This challenge isn't conceptually hard, but it involves actual
  error-prone coding. The other challenges in this set are there to
  bring you up to speed. This one is there to qualify you. If you can do
  this one, you're probably just fine up to Set 6.</p>
</blockquote>

<p>Well, conceptually, this may not be the hardest but practically, it is the first hardest challenge in this set and it really did take me a while to understand how to decrypt the ciphertext through <strong><em>trial-and-error</em></strong> despite the instructions given on the website. In this challenge, it's more like connecting all the puzzles and looking at the big picture, in this case, all of the previous code that I had written, is to break the Repeating-Key XOR cipher.</p>

<h2>How to break it?</h2>

<p>The challenge had given some steps to follow. Here's how:</p>

<ol>
<li>Let <strong><em>KEYSIZE</em></strong> be the guessed length of the key; try values from 2 to (say) 40</li>
<li>Write a function to compute the edit distance/Hamming distance between two strings. To know more about it, <a href="/posts/hamming-distance-algorithm-in-c">click here</a> </li>
<li>For each <strong><em>KEYSIZE</em></strong>, take the first <strong><em>KEYSIZE</em></strong> worth of bytes, and the second <strong><em>KEYSIZE</em></strong> worth of bytes, and find the edit distance between them. Normalize this result by dividing by <strong><em>KEYSIZE</em></strong></li>
<li>The <strong><em>KEYSIZE</em></strong> with the smallest normalized edit distance is probably the key. You could proceed perhaps with the smallest 2-3 <strong><em>KEYSIZE</em></strong> values. Or take 4 <strong><em>KEYSIZE</em></strong> blocks instead of 2 and average the distances</li>
<li>Now that you probably know the <strong><em>KEYSIZE</em></strong>: break the ciphertext into blocks of <strong><em>KEYSIZE</em></strong> length</li>
<li>Now transpose the blocks: make a block that is the first byte of every block, and a block that is the second byte of every block, and so on</li>
<li>Solve each block as if it was single-character XOR. You already have code to do this</li>
<li>For each block, the single-byte XOR key that produces the best looking histogram is the repeating-key XOR key byte for that block. Put them together and you have the key</li>
</ol>

<p>Let's dive in to the code (I hope the comments, help you out!):</p>

<p><strong>Implementation of the method(s):</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1">//Single Byte XOR V2 - a better version</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::singleByteXOR_V2</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//Don&#39;t forget to add a NULL character to the string, it broke when I didn&#39;t add it previously.</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="err">&#39;&#39;</span><span class="p">);</span><span class="w"> </span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">newStr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">key</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//Return the Single Byte XOR key via Bruteforce</span>
<span class="kt">char</span><span class="w"> </span><span class="nf">CryptoLib::singleByteXOR_Bruteforce_key</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">cipherBlock</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">maxCount</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">decodedMessage</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Brute force all 256 possibilities</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">256</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Perform Single Byte XOR -- modified version</span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">singleByteXOR_V2</span><span class="p">(</span><span class="n">cipherBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ch</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// cout &lt;&lt; &quot;Message: &quot; &lt;&lt; attempt &lt;&lt; endl;</span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="cm">/*</span>
<span class="cm">            Look for characters that are alphabetic and the space character,</span>
<span class="cm">            if it finds, increment the counter</span>
<span class="cm">        */</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">attempt</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">((</span><span class="n">attempt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">attempt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">122</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">attempt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">count</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">//The one with the highest count, has the predicted key</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxCount</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">maxCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ch</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="c1">// decrypted = attempt;</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// cout &lt;&lt; &quot;KEY: &quot; &lt;&lt; key &lt;&lt; endl;</span>
<span class="w">    </span><span class="c1">// cout &lt;&lt; &quot;MESSAGE: &quot; &lt;&lt; decrypted &lt;&lt; endl;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">key</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//Guess Key length of the cipher</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">CryptoLib::guess_key_length</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">cipherText</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">KEYSIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">leastNormalized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INT_MAX</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Guess a keysize from 2 to 40</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">40</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">normalize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Number of bytes per key size</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipherText</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">/</span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">bytes</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">string</span><span class="w"> </span><span class="n">blockA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipherText</span><span class="p">.</span><span class="n">substr</span><span class="p">((</span><span class="n">j</span><span class="o">*</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">string</span><span class="w"> </span><span class="n">blockB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipherText</span><span class="p">.</span><span class="n">substr</span><span class="p">(((</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">            </span><span class="c1">//Calculate Hamming Distance between 2 strings</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">edit_distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hamming_distance</span><span class="p">(</span><span class="n">blockA</span><span class="p">,</span><span class="w"> </span><span class="n">blockB</span><span class="p">);</span><span class="w"></span>

<span class="w">            </span><span class="n">normalize</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">edit_distance</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="n">blockA</span><span class="p">.</span><span class="n">size</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Now, take an average </span>
<span class="w">        </span><span class="n">normalize</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">bytes</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">//The key size that has the least edit distance is the key size required</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">normalize</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">normalize</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">leastNormalized</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">leastNormalized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normalize</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">KEYSIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Return the key size</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">KEYSIZE</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong>Final code:</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1">//The Cryptopals Crypto Challenges - Set 1 Challenge 6</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">message</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">binary</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">key</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//if this returns 37, then the function is working correct!</span>
<span class="w">    </span><span class="c1">// cout &lt;&lt; crypt.hamming_distance(&quot;this is a test&quot;, &quot;wokka wokka!!!&quot;) &lt;&lt; endl;</span>

<span class="w">    </span><span class="c1">//Read the file content</span>
<span class="w">    </span><span class="n">ifstream</span><span class="w"> </span><span class="n">infile</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Converted the B64 text to Hexadecimals through an online converter</span>
<span class="w">    </span><span class="c1">//as it wasn&#39;t accurate with b64 decoder that I&#39;d built</span>
<span class="w">    </span><span class="n">infile</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;message.txt&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">getline</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">infile</span><span class="p">.</span><span class="n">close</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Convert the hexadecimal string to ASCII</span>
<span class="w">    </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_hex_2_ascii</span><span class="p">(</span><span class="n">message</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Guess the length of the key</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">keyLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">guess_key_length</span><span class="p">(</span><span class="n">message</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Transpose the message based on keysize length</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">keyLength</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">keyLength</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">block</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">indexKey</span><span class="o">=</span><span class="err">&#39;&#39;</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="cm">/*</span>
<span class="cm">            Transpose the message into blocks </span>
<span class="cm">            based on keysize and concatenate it </span>
<span class="cm">            into one string</span>
<span class="cm">        */</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">blocks</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">block</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="n">substr</span><span class="p">((</span><span class="n">j</span><span class="o">*</span><span class="n">keyLength</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Concatenate the selected characters, which will become the predicted key</span>
<span class="w">        </span><span class="n">key</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">singleByteXOR_Bruteforce_key</span><span class="p">(</span><span class="n">block</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;KEY: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;DECODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_hex_2_ascii</span><span class="p">(</span><span class="n">crypt</span><span class="p">.</span><span class="n">repeatingKeyXOR</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>When the following code is executed, the most probable <strong><em>KEYSIZE</em></strong> is <strong><em>29</em></strong> and after transposing the message and decrypting the blocks, you get a key of that length:</p>

<div class="codehilite"><pre><span></span><code>Terminator X: Bring the noise
</code></pre></div>

<p>Lastly, use the <strong><em>Repeating-Key XOR</em></strong> method to decrypt the message with the cracked key (which looks like lyrics to some music track!):</p>

<div class="codehilite"><pre><span></span><code>A rockin&#39; on the mike while the fly girls yell
Well that&#39;s my DJ Deshay cuttin&#39; all them Z&#39;s
Vanilla&#39;s on the mike, man I&#39;m not lazy. ?I&#39;m lettin&#39; my drug kick in
To just let it flow, let my concepts go
And if you don&#39;t give a damn, then
So get off &#39;cause I control the stage
I&#39;m in my own phase
And I can dance better than any kid n&#39; play ?
Stage 2 -- Yea the one ya&#39; wanna listen to
So I can funk it up and make it sound good
For good luck, I like my rhymes atrocious
I&#39;m an effect and that you can bet
There&#39;s no denyin&#39;, You can try to hang 
Over and over, practice makes perfect
Soon -- Oh my God, homebody, you probably eat
Intoxicating so you stagger like a wino
Vanilla Ice is sellin&#39; and you people are buyin&#39;
Movin&#39; and groovin&#39; trying to sing along
Now you&#39;re amazed by the VIP posse. ?
Steppin&#39; so hard like a German Nazi
There&#39;s no trippin&#39; on mine, I&#39;m just gettin&#39; down
You trapped me once and I thought that
So step down and lend me your ear 
Your body&#39;s gettin&#39; hot, so, so I can smell it
&#39;Cause the lyrics belong to ICE, You can call me Dad 
Let the witch doctor, Ice, do the dance to cure 
You wanna battle me -- Anytime, anywhere ?
You thought that I was weak, Boy, you&#39;re dead wrong 
play that funky music Go white boy, go white boy, go
Play that funky music white boy you say it, say it 
Play that funky music, white boy Come on, Come on, Come on
</code></pre></div>

<p>As mentioned above, this was really challenging and fun, at the same time. Although, Most people (academically) know <strong><em>"how-to"</em></strong> break a Repeating-Key XOR (Vignere Cipher) but being <strong><em>able</em></strong> to break it, is another thing.</p>

<p>Hope you liked reading this article!</p>

<p>But, hang in there, surprisingly, this code will be useful later on for many problems.</p>

	</div>
	<div class="article-footer">
		<time>December 18th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--implement-repeatingkey-xor">The Cryptopals Crypto Challenges: Set 1 - Implement Repeating-Key XOR</a></h1>
		<p class="description">Write a method that encrypts messages using the Repeating-Key XOR method with a given key.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/5">fifth challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided walkthroughs for the previous challenges, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encoding--decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--detect-singlecharacter-xor">The Cryptopals Crypto Challenges: Set 1 - Detect Single-Character XOR</a></li>
</ul>

<p>For this challenge, you have to implement a <strong><em>Repeating-Key XOR</em></strong> method to encrypt the following message:</p>

<div class="codehilite"><pre><span></span><code>Burning &#39;em, if you ain&#39;t quick and nimble
I go crazy when I hear a cymbal
</code></pre></div>

<p>With a given key:</p>

<div class="codehilite"><pre><span></span><code>ICE
</code></pre></div>

<p>The final message should look like this:</p>

<div class="codehilite"><pre><span></span><code>0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272
a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f
</code></pre></div>

<p>If you've already understood the concept of <a href="/posts/base64-encoding-decoding-using-bitwise-manipulation-in-c">XOR</a> and had no issues implementing both <a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">Fixed XOR Cipher</a> and <a href="/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">Single-Byte XOR Cipher</a>, then this should be a piece of cake for you when it comes to implementing <strong><em>Repeating-Key XOR Cipher</em></strong>.</p>

<h2>How does this work?</h2>

<p>With <strong><em>Repeating-Key XOR</em></strong>, you'll sequentially apply each byte of the key (which is "ICE", in this case); the first byte of plaintext will be XOR'd against <strong><em>"I"</em></strong>, the next <strong><em>"C"</em></strong>, the next <strong><em>"E"</em></strong>, then <strong><em>"I"</em></strong> again for the 4th byte, and so on.</p>

<p>You can use this method to encrypt anything you want. Emails, Passwords, Secret messages and so on. You'll definitely get a feel for it because things will get interesting after this challenge.</p>

<p>Let's dive in to the code:</p>

<p><strong>Implementation of the method(s):</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1">//Convert ASCII to HEX</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::con_ascii_2_hex</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//Repeating Key XOR implementation</span>
<span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::repeatingKeyXOR</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        1. Perform XOR against each character of the message </span>
<span class="cm">        against each character of the key. </span>
<span class="cm">        So if the key was &quot;ICE&quot; and the message is &quot;abcdefg&quot;,</span>
<span class="cm">        it would be &quot;a&quot; against &quot;I&quot;, then &quot;b&quot; against &quot;C&quot; and &quot;c&quot; against &quot;E&quot;</span>
<span class="cm">        but once it reaches the key&#39;s limit, you start again from the beginning</span>
<span class="cm">        of the key, which should be like: &quot;d&quot; against &quot;I&quot;, &quot;e&quot; against &quot;C&quot; and so on.</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">[</span><span class="n">count</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">key</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="mi">-1</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">count</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">//2. Convert the ASCII message to Hexadecimal</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">final</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">con_ascii_2_hex</span><span class="p">(</span><span class="n">newStr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">final</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong>Final code:</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1">//Cryptopals Set 1 Challenge 5</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Test cases provided</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Burning &#39;em, if you ain&#39;t quick and nimble I go crazy when I hear a cymbal&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ICE&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ENCODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">repeatingKeyXOR</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong><em>Note: This solution and the library named <mark>crypto.h</mark> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Stay tuned for the next challenge!</p>

	</div>
	<div class="article-footer">
		<time>December 15th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
					
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--singlebyte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR Cipher</a></h1>
		<p class="description">Write a method that decrypts a hexadecimal message that has been XOR'd against a single character.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/3">third challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. Previously, I spoke about these challenges and provided walkthroughs for the previous challenges, if you haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></li>
<li><a href="/posts/base64-encoding--decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR Cipher</a></li>
</ul>

<p>For this challenge, you have to write a method that decodes a
Hexadecimal string:</p>

<div class="codehilite"><pre><span></span><code>1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736
</code></pre></div>

<p>That has been <strong><em>XOR'd</em></strong> against a <strong><em>single character</em></strong>. You must find the key and decrypt the message.</p>

<p>If you have read the <a href="/posts/the-cryptopals-crypto-challenges-set-1--fixed-xor">previous article</a>, it was clearly setup for this problem. There are so many ways to solve this problem but the most efficient way to solve it is by using a <strong><em>Frequency table</em></strong>.</p>

<p>Assuming the message is supposed to be in English, when decrypted, we need to only generate a frequency table using the given Hexadecimal string that shows the frequencies of each <strong><em>alphabet</em></strong>. The character that has the highest frequency is the key required, which is then used to perform an <strong><em>XOR (\^)</em></strong> operation against each character, to decrypt the encrypted message.</p>

<p>Let's have a look at the code:</p>

<div class="codehilite"><pre><span></span><code><span class="c1">//Return Character frequency of a string</span>
<span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">frequency_table</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span><span class="w"> </span><span class="n">it</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">it</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">end</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">m</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//Return character with the highest frequency</span>
<span class="kt">char</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">ret_high_freq_char</span><span class="p">(</span><span class="n">map</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">max_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">max_char</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="nl">p</span><span class="p">:</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">isalpha</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_count</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">max_char</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">max_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">max_char</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//Single Byte XOR</span>
<span class="n">string</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">singleByteXOR</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//1. Convert Hexadecimal to Binary</span>
<span class="w">    </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_spaces</span><span class="p">(</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">str</span><span class="p">),</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//2. Convert Binary to Decimals</span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0</span><span class="p">);</span><span class="w"></span>


<span class="w">    </span><span class="c1">// What&#39;s happening here?</span>
<span class="w">    </span><span class="c1">// 4. Generate a frequency table using the characters from the ASCII string</span>
<span class="w">    </span><span class="c1">// 5. Look for characters that are English and also has the highest frequency</span>
<span class="w">    </span><span class="c1">// 6. The character that has the highest frequency is the KEY!</span>

<span class="w">    </span><span class="c1">//The key</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">toupper</span><span class="p">(</span><span class="n">ret_high_freq_char</span><span class="p">(</span><span class="n">frequency_table</span><span class="p">(</span><span class="n">con_dec_2_ascii</span><span class="p">(</span><span class="n">v</span><span class="p">))));</span><span class="w"></span>

<span class="w">    </span><span class="c1">//7. Perform XOR with the KEY against each character</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">//8. Decoded message</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><strong>Final code:</strong></p>

<div class="codehilite"><pre><span></span><code><span class="c1">//CryptoPals Set 1 Challenge 3</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//Test case provided</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;DECODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">singleByteXOR</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w">   </span>
</code></pre></div>

<p><strong>Decrypted message:</strong></p>

<div class="codehilite"><pre><span></span><code>Key with the highest frequency: &#39;X&#39;
Message: Cooking MC&#39;s like a pound of bacon
</code></pre></div>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Stay tuned for the next challenge!</p>

	</div>
	<div class="article-footer">
		<time>December 13th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

				
			</div>
			
<div class="pagination">
	
		
		<a href="/writings/pages/5">&laquo;</a>
			
	

	
		
			<a class="" href="/writings/">1</a>
		
	
		
			<a class="" href="/writings/pages/3">...</a>
		
	
		
			<a class="" href="/writings/pages/4">4</a>
		
	
		
			<a class="" href="/writings/pages/5">5</a>
		
	
		
			<a class="active" href="/writings/pages/6">6</a>
		
	
		
			<a class="" href="/writings/pages/7">7</a>
		
	
		
			<a class="" href="/writings/pages/8">8</a>
		
	
		
			<a class="" href="/writings/pages/9">9</a>
		
	

	
		<a href="/writings/pages/7">&raquo;</a>
	
</div>

		</section>
		<section id="secondary">
			<div class="sidebar">
				<div class="author-intro">
	<h3>Writings</h3>
	<p>Sometimes, I write stuff about computers, math, technology & design.</p>
	<ul class="sitemap">
		<li><a class="back" href="/"><span>👈</span> Check out more articles!</a></li>
	</ul>
</div>
				<!-- Tags -->
<div>
	<h3>Categories</h3>
	<ul class="tags">
		
		<li>
			<a href="/category/laravel/">
				Laravel
				<span class="count">16</span>
			</a>
		</li>
		
		<li>
			<a href="/category/linux/">
				Linux
				<span class="count">15</span>
			</a>
		</li>
		
		<li>
			<a href="/category/terminal/">
				Terminal
				<span class="count">11</span>
			</a>
		</li>
		
		<li>
			<a href="/category/algorithms/">
				Algorithms
				<span class="count">11</span>
			</a>
		</li>
		
		<li>
			<a href="/category/cryptography/">
				Cryptography
				<span class="count">11</span>
			</a>
		</li>
		
		<li>
			<a href="/category/git/">
				Git
				<span class="count">10</span>
			</a>
		</li>
		
		<li>
			<a href="/category/php/">
				PHP
				<span class="count">10</span>
			</a>
		</li>
		
		<li>
			<a href="/category/javascript/">
				JavaScript
				<span class="count">9</span>
			</a>
		</li>
		
		<li>
			<a href="/category/vim/">
				VIM
				<span class="count">8</span>
			</a>
		</li>
		
		<li>
			<a href="/category/unix/">
				UNIX
				<span class="count">8</span>
			</a>
		</li>
		
		<li>
			<a href="/category/programming/">
				Programming
				<span class="count">8</span>
			</a>
		</li>
		
		<li>
			<a href="/category/mysql/">
				MySQL
				<span class="count">6</span>
			</a>
		</li>
		
		<li>
			<a href="/category/essay/">
				Essay
				<span class="count">6</span>
			</a>
		</li>
		
		<li>
			<a href="/category/update/">
				Update
				<span class="count">5</span>
			</a>
		</li>
		
		<li>
			<a href="/category/devops/">
				DevOps
				<span class="count">5</span>
			</a>
		</li>
		
		<li>
			<a href="/category/tutorial/">
				Tutorial
				<span class="count">5</span>
			</a>
		</li>
		
		<li>
			<a href="/category/personal-challenge/">
				Personal Challenge
				<span class="count">5</span>
			</a>
		</li>
		
		<li>
			<a href="/category/apache/">
				Apache
				<span class="count">4</span>
			</a>
		</li>
		
		<li>
			<a href="/category/arcade-challenge/">
				Arcade Challenge
				<span class="count">4</span>
			</a>
		</li>
		
		<li>
			<a href="/category/productivity/">
				Productivity
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/regular-expressions/">
				Regular Expressions
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/data-structures/">
				Data Structures
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/user-interface/">
				User Interface
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/user-experience/">
				User Experience
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/general/">
				General
				<span class="count">3</span>
			</a>
		</li>
		
		<li>
			<a href="/category/wget/">
				wget
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/vscode/">
				VSCode
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/email/">
				Email
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/bash/">
				Bash
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/wamp/">
				WAMP
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/python/">
				Python
				<span class="count">2</span>
			</a>
		</li>
		
		<li>
			<a href="/category/blogmarks/">
				Blogmarks
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/databases/">
				Databases
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/tooling/">
				Tooling
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/graphics/">
				Graphics
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/selfreflection/">
				Self-reflection
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/security/">
				Security
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/cpanel/">
				cPanel
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/generative-art/">
				Generative Art
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/introduction/">
				Introduction
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/refactoring/">
				Refactoring
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/css/">
				CSS
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/scss/">
				SCSS
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/xfce/">
				XFCE
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/chrome-devtools/">
				Chrome DevTools
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/go/">
				Go
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/ssl/">
				SSL
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/jquery/">
				jQuery
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/art/">
				Art
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/tips/">
				Tips
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/review/">
				Review
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/artificial-intelligence/">
				Artificial Intelligence
				<span class="count">1</span>
			</a>
		</li>
		
		<li>
			<a href="/category/mathematics/">
				Mathematics
				<span class="count">1</span>
			</a>
		</li>
		
	</ul>
</div>
<!-- Tags -->
			</div>
		</section>
	</div>
</main>

<footer>
    <span class="copyright">&copy; Abdush Shakoor</span>
</footer>

<script src="/static/vendor/jquery/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

<script src="/static/js/art.js"></script>

<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script defer id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-98290003-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-98290003-2');
</script>

<!-- <script>
    const darkModeButton = document.createElement('button');
    const syntaxHighlightSource = document.getElementById('syntaxHighlight');
    const menuList = document.querySelector('.menu');
    const themeSettings = {
        "dark": {
            "icon": '<i class="ph-moon-fill"></i>',
            "hljs": "/static/vendor/hljs/css/github-dark.css",
        },
        "light": {
            "icon": '<i class="ph-sun-fill"></i>',
            "hljs": "/static/vendor/hljs/css/github.min.css",
        },
    }

    function highlightMenuLink() {
        var currentURI = window.location.href;
        currentURI = currentURI.replace(window.location.protocol + "//", "");
        var currentPage	 = currentURI.split('/')[1];

        if(currentPage) {
            $('a[href="/' + currentPage + '"').parent().addClass('active');
        }
    }
    
    function initThemeSwitcher() {
        darkModeButton.innerHTML = themeSettings.light.icon;
        darkModeButton.classList.add('darkModeButton');
        
        darkModeButton.addEventListener('click', function(){
            switch(document.documentElement.getAttribute('data-theme')) {
                case 'dark':
                    lightMode();
                    break;

                case 'light':
                default:
                    darkMode();
                    break;
            }
        });
        
        var newItem = document.createElement('li');
        newItem.appendChild(darkModeButton);
        menuList.insertBefore(newItem, menuList.childNodes[menuList.childNodes - 1]);
    }
    

    // Settings for dark mode
    function darkMode() {
        darkModeButton.innerHTML = themeSettings.dark.icon;
        document.documentElement.setAttribute('data-theme', 'dark');
        syntaxHighlightSource.setAttribute('href', themeSettings.dark.hljs);
        localStorage.setItem("theme", "dark");
    }

    // Settings for light mode
    function lightMode() {
        darkModeButton.innerHTML = themeSettings.light.icon;
        document.documentElement.setAttribute('data-theme', '');
        syntaxHighlightSource.setAttribute('href', themeSettings.light.hljs);
        localStorage.setItem("theme", "");
    }

    function checkTheme() {
        const localStorageTheme = localStorage.getItem("theme");
        switch(localStorageTheme) {
            case "dark":
                darkMode();
                break;
            
            default:
                lightMode();
                break;
        }
    }

    // Check if the theme is stored in session
    window.onload = function() {
        initThemeSwitcher();
        checkTheme();
        highlightMenuLink();
    }

    //  open and close nav 
    $('#navbar-toggle').click(function() {
      $('nav ul').slideToggle();
    });

    // Hamburger toggle
    $('#navbar-toggle').on('click', function() {
      this.classList.toggle('active');
    });

    // Click outside the dropdown will remove the dropdown class
    $('html').click(function() {
      $('.navbar-dropdown').hide();
    });
</script> -->
</body>
</html>