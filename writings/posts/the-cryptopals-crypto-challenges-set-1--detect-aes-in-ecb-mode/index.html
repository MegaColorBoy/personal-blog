<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>The Cryptopals Crypto Challenges: Set 1 - Detect AES in ECB Mode | megacolorboy</title>
	<link rel="stylesheet" href="/static/css/main.css" type="text/css">
	<link rel="stylesheet" href="/static/vendor/hljs/css/default.min.css">
	<!-- Add OG tags  -->
</head>
<body class="details-page writings">
	<!-- Navbar -->
	<header class="header">
	<div class="author">
		<a href="/">
			<div class="logo"></div>
			<p>megacolorboy</p>
		</a>
	</div>
	<nav>
		<ul class="menu">
			
				<li><a href="/about">About</a></li>
			
				<li><a href="/writings">Writings</a></li>
			
				<li><a href="/til">Today I Learned</a></li>
			
		</ul>
	</nav>
</header>

<div class="article-top">
	<a class="back" href="/writings"><span>&larr;</span> Back</a>
	<p class="date">Published on December 29th, 2017</p>	
</div>

<main>
	<section class="article-head">
		<p class="cat">Cryptography</p>
		<h1>The Cryptopals Crypto Challenges: Set 1 - Detect AES in ECB Mode</h1>
		
			<p>Find the string that has been encrypted with AES-128 cipher with an ECB mode in a file of ciphertexts.</p>
		
		<p class="date">2 minutes read</p>
	</section>
	<article>
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/8">eighth
challenge</a> of Set 1 in The
Cryptopals Crypto Challenges website. Previously, I spoke about these
challenges and provided walkthroughs for the previous challenges, if you
haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto
Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to
Base64</a></li>
<li><a href="/posts/base64-encoding-decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in
C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR
Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-single-byte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR
Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-detect-single-character-xor">The Cryptopals Crypto Challenges: Set 1 - Detect Single-Character
XOR</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-implement-repeating-key-xor">The Cryptopals Crypto Challenges: Set 1 - Implement Repeating-Key
XOR</a></li>
<li><a href="/posts/hamming-distance-algorithm-in-c">Hamming Distance Algorithm in
C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-break-repeating-key-xor">The Cryptopals Crypto Challenges: Set 1 - Break Repeating-Key
XOR</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-aes-in-ecb-mode">The Cryptopals Crypto Challenges: Set 1 - AES in ECB
Mode</a></li>
</ul>

<p>For this challenge, you are given a
<a href="http://cryptopals.com/static/challenge-data/8.txt">file</a>, which
contains a bunch of ciphertexts that has been encrypted using <strong><em>AES-128
Cipher</em></strong> but only one of them has an <strong><em>ECB (Electronic Codebook)</em></strong> mode.
Find the string the string that has the ECB mode.</p>

<p>In the <a href="/posts/the-cryptopals-crypto-challenges-set-1-aes-in-ecb-mode">previous
post</a>,
I had explained that <strong><em>ECB</em></strong> is a cipher mode that is used to repeat the
key until it covers the entire plaintext i.e. the same 16 byte plaintext
will have the same 16 byte ciphertext.</p>

<p>Well, the solution is pretty much trivial, so here's the solution:</p>

<p><strong>Implementation of the method(s):</strong></p>

<pre>
    <code class="cpp">
    //Detect ECB Mode in AES Cipher
    bool CryptoLib::detect_ecb_mode(string str, int keyLength)
    {
        //Divide into equal amount of blocks
        int blocks = str.size() / keyLength;

        /*
            Theory: the problem with ECB as I had mentioned
            in the previous post, it uses the exact number of bytes of the ciphertext
            to encrypt the plaintext repeatedly.

            In that case, just do the reverse.

            Divide it into equal amount of blocks, in this case, we
            know the key is "YELLOW SUBMARINE", which is 16 bytes.

            Then, all you have to do is take two substrings of a string and compare,
            if they have the same string, we found it!
        */
        for(int i=0; i&lt;blocks; i++)
        {
            //Take a substring of x number of bytes
            string strA = str.substr(i*keyLength, keyLength);

            for(int j=i+1; j&lt;blocks; j++)
            {
                //Take another substring of x number of bytes
                string strB = str.substr(j*keyLength, keyLength);
                if(strA == strB)
                {
                    //Found
                    return true;
                }
            }
        }
        return false;
    }
    </code>
</pre>

<p><strong>Final code:</strong></p>

<pre>
    <code class="cpp">
    //The Cryptopals Crypto Challenges - Set 1 Challenge 8
    #include "crypto.h"

    int main()
    {
        CryptoLib crypt;

        string str;

        ifstream infile;
        infile.open("8.txt");

        int count = 0;
        while(!infile.eof())
        {
            getline(infile, str);

            //Check if this string has ECB mode
            if(crypt.detect_ecb_mode(str, 16) == true)
            {
                cout << "FOUND AT LINE " << count << " => " << str << endl;
                break;
            }
            count++;
        }
    }
    </code>
</pre>

<p><strong><em>Note: This solution and the library named <mark>crypto.h</mark> was
built using the C++ programming language. The source code for this
solution can be found on Github.</em></strong></p>

<p>Well, this challenge marks the end of Set 1 from The Cryptopals Crypto
Challenges. However, I do intend to continue solving all these crypto
challenges, let's see how it goes!</p>

<p>Until next time, then!</p>

	</article>
</main>

<script src="/static/vendor/jquery/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="/static/vendor/hljs/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>