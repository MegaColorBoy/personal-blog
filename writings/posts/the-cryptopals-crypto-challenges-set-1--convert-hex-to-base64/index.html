<!DOCTYPE html>
<html data-theme="" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Abdush Shakoor">
	
	<meta name="description" content="Convert Hexadecimal strings to encoded Base64 strings..">
	<meta name="og:title" content="The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64 | Abdush Shakoor's Weblog" />
	<meta name="og:type" content="article" />
	<meta name="og:url" content="writings/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64" />
	<meta name="og:description" content="Convert Hexadecimal strings to encoded Base64 strings." />
	<meta name="og:site_name" content="Abdush Shakoor's Weblog | Abdush Shakoor's Weblog" />
	
	<meta name="robots" content="follow">
	<title>The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64 | Abdush Shakoor's Weblog </title>
	<link rel="stylesheet" href="/static/css/main.css" type="text/css">
	<link rel="stylesheet" href="/static/css/pygments.css" type="text/css">

	<link rel="apple-touch-icon" sizes="57x57" href="/static/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/static/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/static/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/static/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/static/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/static/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/static/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/static/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/static/favicon/png" sizes="192x192"  href="/static/favicon/android-icon-192x192.png">
<link rel="icon" type="image/static/favicon/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
<link rel="icon" type="image/static/favicon/png" sizes="96x96" href="/static/favicon/favicon-96x96.png">
<link rel="icon" type="image/static/favicon/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
<link rel="manifest" href="/static/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
	
	<!-- <script src="https://unpkg.com/phosphor-icons"></script> -->
	<!-- <script>
		if(localStorage.theme){
			document.documentElement.setAttribute('data-theme', localStorage.getItem("theme"));
		}
	</script> -->
</head>
<body class="">
	<!-- Navbar -->
	<header class="header">
	<!-- Logo with Author Name -->
	<div class="author">
		<a href="/">
			<img src="/static/logo.png" alt="megacolorboy">
			<div class="name">
				<h1>Abdush Shakoor's Weblog</h1>
				<p>Writings, experiments & ideas.</p>
			</div>
		</a>
	</div>
	<!-- Logo with Author Name -->
	<nav>
		<ul class="menu">
			
				<li><a href="/about">About</a></li>
			
				<li><a href="/archive">Archive</a></li>
			
				<li><a href="/resume">Resume</a></li>
			
		</ul>
	</nav>	
</header>

<main>
	<div class="two-col-grid">
		<section id="primary">
			<div class="articles">
				
<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to Base64</a></h1>
		<p class="description">Convert Hexadecimal strings to encoded Base64 strings.</p>
	</div>
	<div class="article-body">
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/1">first challenge</a> of Set 1 in The Cryptopals Crypto Challenges website. If you want to know more about these challenges, look at my <a href="/posts/the-cryptopals-crypto-challenges">previous post</a>.</p>

<p>For this challenge, you need to be able to convert Hexadecimal strings to encoded Base64 strings:</p>

<p>The string:</p>

<pre><code>49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d
</code></pre>

<p>Should produce:</p>

<pre><code>SSdtIGtpbGxpbmcgeW91ciBicmFpbiBsaWtlIGEgcG9pc29ub3VzIG11c2hyb29t
</code></pre>

<p>Not only is this challenge just a warmup but it is also designed to make you feel comfortable in dealing with raw bytes as Base64 is used to encode binary information and Hexadecimal is used to view the raw bytes.</p>

<h2>How to convert from Hexadecimal to Base64?</h2>

<p>Well, it's simpler than you think! You will have to go through the following steps:</p>

<ol>
<li><a href="#step-1">Convert hexadecimal string to binary string</a></li>
<li><a href="#step-2">Split the binary string into 4 pieces of 6 bits each</a></li>
<li><a href="#step-3">Convert the binary string to decimal</a></li>
<li><a href="#step-4">Compare each decimal against each character in a reference string of 64 characters</a></li>
</ol>

<h3><a id="step-1"></a> Convert hexadecimal string to binary string</h3>

<p>Before converting to binary, you should compare each character against a hashmap table of hardcoded hexadecimal keys and binary values.</p>

<pre><code>//Hashmap that contain hex key and binary values
map&lt;char, string&gt; CryptoLib::gen_hex_table()
{
    map&lt;char, string&gt; map;

    map['0'] = "0000";
    map['1'] = "0001";
    map['2'] = "0010";
    map['3'] = "0011";
    map['4'] = "0100";
    map['5'] = "0101";
    map['6'] = "0110";
    map['7'] = "0111";
    map['8'] = "1000";
    map['9'] = "1001";
    map['a'] = "1010";
    map['b'] = "1011";
    map['c'] = "1100";
    map['d'] = "1101";
    map['e'] = "1110";
    map['f'] = "1111";

    return map;
}

//Convert hex to string
string CryptoLib::con_hex_2_bin(string hexStr)
{
    map&lt;char,string&gt; m = gen_hex_table();

    string newStr = "";
    for(int i=0; i &lt;hexStr.size(); i++)
    {
        if(isdigit(hexStr[i]))
        {
            newStr += m.find(hexStr[i])-&gt;second;
        }
        else
        {
            newStr += m.find(hexStr[i])-&gt;second;
        }
        // newStr += m.find(hexStr[i])-&gt;second;
    }
    return newStr;
}
</code></pre>

<h3><a id="step-2"></a> Split the binary string into 4 pieces of 6 bits each</h3>

<p>Base64 represents data in the form of ASCII format that follows a Radix-64 representation. Each character is picked from a set of 64 characters, which means that I'll only need 6 bits represent each character because <strong>2<sup>6</sup> = 64 characters</strong>.</p>

<pre><code>//Add spaces between strings
string CryptoLib::add_spaces(string str, int spaces)
{
    string newStr = "";
    int count = 0;

    for(int i=0; i&lt;str.size(); i++)
    {

        // newStr += str[i];
        if(count == spaces)
        {
            newStr += " ";
            i--;
            count = 0;
        }
        else
        {
            newStr += str[i];
            count++;
        }
    }

    return newStr;
}
</code></pre>

<h3><a id="step-3"></a> Convert the binary string to decimal</h3>

<p>Before converting, you should know that a decimal number is equal to the sum of binary digits (d~n~) times their power of 2 (2<sup>n</sup>).</p>

<p>Let's say you have a binary string of <mark>111001</mark>, it's decimal
would be <mark>1x2<sup>5</sup> + 1x2<sup>4</sup> + 1x2<sup>3</sup> + 0x2<sup>2</sup> + 0x2<sup>1</sup> + 1x2<sup>0</sup> =
57</mark></p>

<pre><code>//Convert binary to decimal
vector&lt;int&gt; CryptoLib::con_bin_2_dec(string str, double power)
{
    vector&lt;int&gt; v;
    string newStr = "";
    istringstream iss(str);
    string x;

    while(iss &gt;&gt; x)
    {
        double p = power;
        double decimal = 0.0;

        for(int i=0; i&lt;x.size(); i++)
        {
            if(x[i] == '1')
            {
                decimal += pow(2.0, p);
            }
            p--;
        }
        v.push_back((int)decimal);
    }
    return v;
}
</code></pre>

<h3><a id="step-4"></a> Compare each decimal against each character in a reference string of 64 characters</h3>

<p>At this stage, all you have to do is find and concatenate each character (using the reference string) based on each decimal and return your encoded Base64 string as the final output.</p>

<pre><code>//Convert HEX to Base 64
string CryptoLib::con_hex_2_b64(string str)
{
    string b64 = "";
    string ref = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    string newStr = add_spaces(con_hex_2_bin(str), 6);

    vector&lt;int&gt; v = con_bin_2_dec(newStr, 5.0);

    for(int i=0; i&lt;v.size(); i++)
    {
        b64 += ref[v[i]];
    }

    return b64;
}
</code></pre>

<p>Here's the final section of the code:</p>

<pre><code>//CryptoPals Set 1 Challenge 1
#include "crypto.h"

int main()
{
    CryptoLib crypt;

    //Test case provided from the site
    string str = "49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d";
    cout &lt;&lt; crypt.con_hex_2_b64(str) &lt;&lt; endl;
    return 0;
}
</code></pre>

<p><strong><em>Note: This solution and the library named <code>crypto.h</code> was built using the C++ programming language. The source code for this solution can be found on Github.</em></strong></p>

<p>Stay tuned for the next challenge.</p>

	</div>
	<div class="article-footer">
		<time>December 6th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/cryptography/">
					Cryptography
				</a>
			</li>
			
		</ul>
	</div>
</div>

			</div>
		</section>
		<section id="secondary">
			<div class="sidebar">
				<div class="author-intro">
	<h3>Hello, I'm Abdush Shakoor! &#x1F44B;</h3>
	<p>I'm a programmer & designer based in Dubai, United Arab Emirates. I love tinkering with code and writing about what I learn.</p>
	<p>Like this article? Please share it with your friends and colleagues or else, <a href="mailto:megacolorboy@gmail.com">send me</a> a private message about your feedback.</p>

	<ul class="sitemap">
		<li><a class="back" href="/"><span>👈</span> Check out more articles!</a></li>
	</ul>
</div>
			</div>
		</section>
	</div>
</main>

<footer>
    <span class="copyright">&copy; Abdush Shakoor</span>
</footer>

<script src="/static/vendor/jquery/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

<script src="/static/js/art.js"></script>

<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script defer id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-98290003-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-98290003-2');
</script>
<script src="/static/vendor/jquery-lazy/jquery.lazy.min.js"></script>
<script>
  $(function () {
    $('.lazy').lazy();
  });
</script>
<!-- <script>
    const darkModeButton = document.createElement('button');
    const syntaxHighlightSource = document.getElementById('syntaxHighlight');
    const menuList = document.querySelector('.menu');
    const themeSettings = {
        "dark": {
            "icon": '<i class="ph-moon-fill"></i>',
            "hljs": "/static/vendor/hljs/css/github-dark.css",
        },
        "light": {
            "icon": '<i class="ph-sun-fill"></i>',
            "hljs": "/static/vendor/hljs/css/github.min.css",
        },
    }

    function highlightMenuLink() {
        var currentURI = window.location.href;
        currentURI = currentURI.replace(window.location.protocol + "//", "");
        var currentPage	 = currentURI.split('/')[1];

        if(currentPage) {
            $('a[href="/' + currentPage + '"').parent().addClass('active');
        }
    }
    
    function initThemeSwitcher() {
        darkModeButton.innerHTML = themeSettings.light.icon;
        darkModeButton.classList.add('darkModeButton');
        
        darkModeButton.addEventListener('click', function(){
            switch(document.documentElement.getAttribute('data-theme')) {
                case 'dark':
                    lightMode();
                    break;

                case 'light':
                default:
                    darkMode();
                    break;
            }
        });
        
        var newItem = document.createElement('li');
        newItem.appendChild(darkModeButton);
        menuList.insertBefore(newItem, menuList.childNodes[menuList.childNodes - 1]);
    }
    

    // Settings for dark mode
    function darkMode() {
        darkModeButton.innerHTML = themeSettings.dark.icon;
        document.documentElement.setAttribute('data-theme', 'dark');
        syntaxHighlightSource.setAttribute('href', themeSettings.dark.hljs);
        localStorage.setItem("theme", "dark");
    }

    // Settings for light mode
    function lightMode() {
        darkModeButton.innerHTML = themeSettings.light.icon;
        document.documentElement.setAttribute('data-theme', '');
        syntaxHighlightSource.setAttribute('href', themeSettings.light.hljs);
        localStorage.setItem("theme", "");
    }

    function checkTheme() {
        const localStorageTheme = localStorage.getItem("theme");
        switch(localStorageTheme) {
            case "dark":
                darkMode();
                break;
            
            default:
                lightMode();
                break;
        }
    }

    // Check if the theme is stored in session
    window.onload = function() {
        initThemeSwitcher();
        checkTheme();
        highlightMenuLink();
    }

    //  open and close nav 
    $('#navbar-toggle').click(function() {
      $('nav ul').slideToggle();
    });

    // Hamburger toggle
    $('#navbar-toggle').on('click', function() {
      this.classList.toggle('active');
    });

    // Click outside the dropdown will remove the dropdown class
    $('html').click(function() {
      $('.navbar-dropdown').hide();
    });
</script> -->
</body>
</html>