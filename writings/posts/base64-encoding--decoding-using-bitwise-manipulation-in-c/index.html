<!DOCTYPE html>
<html data-theme="" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Abdush Shakoor">
	<title>Base64 Encoding / Decoding using Bitwise Manipulation in C++ | Abdush Shakoor's Weblog </title>

	
	
	<link rel="stylesheet" href="/static/css/main.css" type="text/css">
	<link rel="stylesheet" href="/static/css/pygments.css" type="text/css">
	<link href="/static/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
	
	<script src="https://unpkg.com/phosphor-icons"></script>
	<!-- Add OG tags  -->

	<script>
		if(localStorage.theme){
			document.documentElement.setAttribute('data-theme', localStorage.getItem("theme"));
		}
	</script>

</head>
<body class="">
	<!-- Navbar -->
	<header class="header">
	<!-- Logo with Author Name -->
	<div class="author">
		<a href="/">
			<img src="/static/logo.png" alt="megacolorboy">
			<div class="name">
				<h1>Abdush Shakoor's Weblog</h1>
				<p>Writings, experiments & ideas.</p>
			</div>
		</a>
	</div>
	<!-- Logo with Author Name -->
	<nav>
		<ul class="menu">
			
				<li><a href="/about">About</a></li>
			
				<li><a href="/archive">Archive</a></li>
			
		</ul>
	</nav>	
</header>

<main>
	<div class="two-col-grid">
		<section id="primary">
			<div class="articles">
				<div class="article">
	<div class="article-header">
		<h1 class="heading"><a href="/writings/posts/base64-encoding--decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in C++</a></h1>
		<p class="description">An alternate solution to the previous post on how to encode/decode hexadecimals to Base64 and vice-versa using Bitwise Manipulation.</p>
	</div>
	<div class="article-body">
		<p>In the <a href="/posts/the-cryptopals-crypto-challenges-set-1--convert-hex-to-base64">previous
post</a>,
I provided the walkthrough for the first challenge of Set 1 in The
Cryptopals Crypto Challenges website but then I realized that I didn't
write a method that could decode the Base64 string back to it's original
Hexadecimal format. So I went back to the website again and found an
important rule that I should have not ignored, at the very beginning:</p>

<blockquote>
  <p>Cryptopals Rule:</p>
  
  <p>Always operate on raw bytes, never on encoded strings. Only use Hex
  and Base64 for pretty-printing.</p>
</blockquote>

<p>Although, the solution I had provided in the first one works, but
there's no way that I could go back to displaying the original
Hexadecimal string. So I went on <strong>Wikipedia</strong> and did some research on
Base64 and I figured out that I should brush up my knowledge on <a href="https://en.wikipedia.org/wiki/Bit_manipulation">Bitwise
Manipulation</a> as I never
had a use for it until now.</p>

<p>In this post, which should be pretty much straightforward (and probably
longer too), I will be talking about Bitwise Manipulation and it's
operators and also provide an alternate walkthrough for the first
challenge of The Cryptopals Crypto Challenges.</p>

<h2>What is Bitwise Manipulation?</h2>

<p>Bitwise Manipulation is a low-level, algorithmic technique used to
manipulate bits or data that are shorter than a word. This technique is
mostly used on embedded controls, data compression, encryption
algorithms and error-detection.</p>

<p>As I mentioned above, most programmers don't get to use this technique a
lot as most programming languages allows the programmer to work on
abstractions directly instead of bits that represent those abstractions.</p>

<p>A program that implements bitwise manipulation, makes use of the
following operators:</p>

<ul>
<li>Bit Shifts (&lt;&lt; / &gt;&gt;)</li>
<li>AND (&amp;)</li>
<li>OR (|)</li>
<li>NOT (!)</li>
<li>XOR (\^)</li>
</ul>

<h3>Bit Shift operations</h3>

<p>Let's take a look at both the left <strong><em>&lt;&lt;</em></strong> and right
<strong><em>&gt;&gt;</em></strong> shift operators. So if you use either of them, you
would be shifting <strong><em>x</em></strong> number of bits to left or right in a
variable.</p>

<p>Let's say we have the number <strong><em>x = 4</em></strong>, and it's binary form is
<strong><em>00000100</em></strong> and we wanted to shift by 4 bits to the left, we
just have to call <strong><em>x &lt;&lt; 4</em></strong>, the result would be
<strong><em>00100000</em></strong>, which means <strong><em>x = 64</em></strong>. Shifting to the
left is the equivalent of multiplication by the power of <strong><em>n</em></strong>
because <strong><em>4x2^4^ = 64</em></strong>. Similarly, shifting to the right is
the equivalent of division by the power of <strong><em>n</em></strong> because
<strong><em>4 / 2^4^ = 4</em></strong> and it's binary form would be
<strong><em>00000100</em></strong>.</p>

<h3>AND, OR and NOT operations</h3>

<p>The bitwise operator <strong>AND</strong> is useful, when you want to check a bit is
on or off i.e. <strong><em>0</em></strong> or <strong><em>1</em></strong>. Whereas for the bitwise
operator <strong>OR</strong> is the exact opposite, if either bit is on, then the
result will be <strong><em>1</em></strong>, else it will be <strong><em>0</em></strong>. Finally,
the bitwise operator <strong>NOT</strong> is used for inverting the bits in a binary,
for example, if you had a binary string of <strong><em>00101000</em></strong>, you'd
get <strong><em>11010111</em></strong>, it is used best when you want to turn off a
bit combined with the <strong>AND</strong> operator.</p>

<h3>XOR operator</h3>

<p>Relax, this ain't scary, this is also known as <strong>Exclusive-OR</strong>. This
operator works when both bits that are compared are either
<strong><em>0</em></strong> or <strong><em>1</em></strong>, then the result will be
<strong><em>0</em></strong>, else it will be <strong><em>1</em></strong>. So if you perform an XOR
on <strong><em>01001000</em></strong> and <strong><em>01000100</em></strong>, the result will be
<strong><em>00001100</em></strong>.</p>

<p>I hope that by now, you must have understood the basic concept of
Bitwise Manipulation, if not, then spend some time reading about it
before scrolling down to the next topic i.e. on how it's applied to
encode and decode Hexadecimal strings to Base64 strings and vice-versa.</p>

<h2>Base64 Encoding</h2>

<p>Before you get started, please keep a couple of things in your mind:</p>

<ul>
<li>Each Hexadecimal character has 4 bits (Base 16)</li>
<li>Each Base64 character has 6 bits (Base 32)</li>
<li>We will be using the standard MIME-Base64 Encoding, thus we will have to use <strong><em>'+'</em></strong> and <strong><em>'/'</em></strong> characters as well</li>
</ul>

<p>Now that we have the facts, doing a simple math states that every 3
Hexadecimal characters is equal to 2 Base64 characters, since the least
common multiple between 4 and 6 is 12. In order to do this, we are going
to make use of our Bitwise Operators, let's have a look at the method:</p>

<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="c1">//Base64 Encoder</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::b64_encode</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Number of bytes per 12 bits</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">padding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Padding must be either 0 or 1</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">padding</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Number of characters to be encoded is 3</span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">+=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">//iterate every 3 chars</span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">//Get every 3 chars</span>
<span class="w">            </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">            </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">            </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>

<span class="w">            </span><span class="c1">//Now, convert each hex character (base 16) to it&#39;s equivalent decimal number</span>
<span class="w">            </span><span class="c1">//and merge them into one variable</span>
<span class="w">            </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strtoull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="c1">//shift left by 8 bits</span>
<span class="w">            </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">strtoull</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="c1">//shift left by 4 bits</span>
<span class="w">            </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">strtoull</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span><span class="w"> </span><span class="c1">//no shift required only the first 2 characters need</span>

<span class="w">            </span><span class="c1">//HEX: 0x3F -&gt; DEC: 63 -&gt; ASCII: ?</span>

<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0x3F</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">)];</span><span class="w"> </span><span class="c1">//first b64 char; shift to right by 6 bits</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0x3F</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">h</span><span class="p">];</span><span class="w"> </span><span class="c1">//second b64 char</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">//if padding is required</span>
<span class="w">        </span><span class="c1">//Follows the same pattern as the above.</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">padding</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">char</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span><span class="w"></span>
<span class="w">            </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strtoull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="c1">// shift left by 8 bits</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0x3F</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">)];</span><span class="w"></span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">//add this towards the end of the encoded string</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span><span class="w"></span>

<span class="n">If</span><span class="w"> </span><span class="n">you</span><span class="err">&#39;</span><span class="n">re</span><span class="w"> </span><span class="n">wondering</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ASCII</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"></span>
<span class="k">do</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ASCII</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Hexadecimal</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="k">this</span><span class="w"></span>
<span class="n">method</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Base64</span><span class="w"> </span><span class="n">encoded</span><span class="w"> </span><span class="n">string</span><span class="p">.</span><span class="w"></span>

<span class="cp">## Base64 Decoding</span>

<span class="n">What</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">wanted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">string</span><span class="o">?</span><span class="w"> </span><span class="n">Well</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">what</span><span class="w"></span>
<span class="n">we</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="n">next</span><span class="p">.</span><span class="w"> </span><span class="n">Unlike</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">post</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">have</span><span class="w"></span>
<span class="n">noticed</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">didn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">Hashmaps</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Base64</span><span class="w"></span>
<span class="n">characters</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">wanted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">approach</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">thought</span><span class="w"> </span><span class="n">of</span><span class="w"></span>
<span class="n">increasing</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">efficiency</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">course</span><span class="p">,</span><span class="w"> </span><span class="n">keeping</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">simple</span><span class="p">.</span><span class="w"></span>

<span class="n">Let</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nl">method</span><span class="p">:</span><span class="w"></span>

<span class="err">```</span><span class="n">cpp</span><span class="w"></span>
<span class="w">    </span><span class="c1">//Base64 Decoder</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">CryptoLib</span><span class="o">::</span><span class="n">b64_decode</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0123456789abcdef&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Check if this is a valid b64 string</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">//Number of bytes for hexadecimals</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">build</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="n">convert</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">make_entry</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">ssg</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="n">ssg</span><span class="p">.</span><span class="n">pyc</span><span class="w"> </span><span class="n">templates</span><span class="w"> </span><span class="n">transfer</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="n">venv</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">//iterate every 2 chars</span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">h</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="c1">//shift 6 bits to the left</span>

<span class="w">                </span><span class="c1">//Check if the value is in the range of A-Z</span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x41</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x5a</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0x41</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="c1">//Check if the value is in the range of a-z</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x61</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x7a</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0x47</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="c1">//Check if the value is in the range of 0-9</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x30</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0x39</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x04</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="c1">//Check if the value is a &#39;+&#39;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x2b</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0x3e</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="c1">//Check if the value is a &#39;/&#39;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x2f</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">h</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0x3f</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="c1">//Check if the value is a &#39;=&#39;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x3d</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0xf</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)];</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="c1">//Shift to the right by 8 bits</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0xf</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)];</span><span class="w"></span>
<span class="w">            </span><span class="c1">//Shift to the right by 4 bits</span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0xf</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)];</span><span class="w"></span>
<span class="w">            </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ref</span><span class="p">[</span><span class="mh">0xf</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">h</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>In the final code, I just converted an ASCII string to Base64 string,
let's have a look at it:</p>

<p><strong>Methods to convert ASCII string to Hexadecimal string and
vice-versa:</strong>
    <div class="codehilite"><pre><span></span><code><span class="c1">//Convert ASCII to HEX</span>
    <span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::con_ascii_2_hex</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"></span>
    <span class="p">{</span><span class="w"></span>
    <span class="w">    </span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span><span class="w"></span>
    <span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
    <span class="w">    </span><span class="p">{</span><span class="w"></span>
    <span class="w">        </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
    <span class="w">    </span><span class="p">}</span><span class="w"></span>
    <span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span><span class="w"></span>
    <span class="p">}</span><span class="w"></span>
 <br />
    <span class="c1">//Convert HEX to ASCII</span>
    <span class="n">string</span><span class="w"> </span><span class="nf">CryptoLib::con_hex_2_ascii</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"></span>
    <span class="p">{</span><span class="w"></span>
    <span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">newStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
    <span class="w">    </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_spaces</span><span class="p">(</span><span class="n">con_hex_2_bin</span><span class="p">(</span><span class="n">str</span><span class="p">),</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w"></span>
    <span class="w">    </span><span class="n">vector</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">con_bin_2_dec</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0</span><span class="p">);</span><span class="w"></span>
 <br />
    <span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
    <span class="w">    </span><span class="p">{</span><span class="w"></span>
    <span class="w">        </span><span class="n">newStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
    <span class="w">    </span><span class="p">}</span><span class="w"></span>
    <span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">newStr</span><span class="p">;</span><span class="w"></span>
    <span class="p">}</span><span class="w"></span>
    </code></pre></div></p>

<p><strong>Final Code:</strong>
    <div class="codehilite"><pre><span></span><code><span class="c1">//CryptoPals Set 1 Challenge 1</span>
    <span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crypto.h&quot;</span><span class="cp"></span>
 <br />
    <span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
    <span class="p">{</span><span class="w"></span>
    <span class="w">    </span><span class="n">CryptoLib</span><span class="w"> </span><span class="n">crypt</span><span class="p">;</span><span class="w"></span>
 <br />
    <span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_ascii_2_hex</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span><span class="w"></span>
    <span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">enc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">b64_encode</span><span class="p">(</span><span class="n">str</span><span class="p">);</span><span class="w"> </span>
    <span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ENCODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">enc</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
 <br />
    <span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">dec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">.</span><span class="n">con_hex_2_ascii</span><span class="p">(</span><span class="n">crypt</span><span class="p">.</span><span class="n">b64_decode</span><span class="p">(</span><span class="n">enc</span><span class="p">));</span><span class="w"></span>
    <span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;DECODED: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">dec</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
    <span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
    <span class="p">}</span><span class="w"></span>
    </code></pre></div></p>

<p><strong><em>Note: This solution and the library named <mark>crypto.h</mark> was
built using the C++ programming language. The source code for this
solution can be found on Github.</em></strong></p>

<p>Hope you guys liked reading this article!</p>

<p>Until next time, then!</p>

	</div>
	<div class="article-footer">
		<time>December 11th, 2017</time>
		<ul class="tags">
			
			<li>
				<a href="/category/algorithms/">
					Algorithms
				</a>
			</li>
			
			<li>
				<a href="/category/programming/">
					Programming
				</a>
			</li>
			
		</ul>
	</div>
</div>
			</div>
		</section>
		<section id="secondary">
			<div class="sidebar">
				<div class="author-intro">
	<h3>Hello, I'm Abdush Shakoor! &#x1F44B;</h3>
	<p>I'm a programmer & designer based in Dubai, United Arab Emirates. I love tinkering with code and writing about what I learn.</p>
	<p>Like this article? Please share it with your friends and colleagues or else, <a href="mailto:megacolorboy@gmail.com">send me</a> a private message about your feedback.</p>

	<ul class="sitemap">
		<li><a class="back" href="/"><span>ðŸ‘ˆ</span> Check out more articles!</a></li>
	</ul>
</div>
			</div>
		</section>
	</div>
</main>

<footer>
    <span class="copyright">&copy; Abdush Shakoor</span>
</footer>

<script src="/static/vendor/jquery/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<!-- <script src="/static/vendor/hljs/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script> -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-98290003-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-98290003-2');
</script>

<!-- <script>
    const darkModeButton = document.createElement('button');
    const syntaxHighlightSource = document.getElementById('syntaxHighlight');
    const menuList = document.querySelector('.menu');
    const themeSettings = {
        "dark": {
            "icon": '<i class="ph-moon-fill"></i>',
            "hljs": "/static/vendor/hljs/css/github-dark.css",
        },
        "light": {
            "icon": '<i class="ph-sun-fill"></i>',
            "hljs": "/static/vendor/hljs/css/github.min.css",
        },
    }

    function highlightMenuLink() {
        var currentURI = window.location.href;
        currentURI = currentURI.replace(window.location.protocol + "//", "");
        var currentPage	 = currentURI.split('/')[1];

        if(currentPage) {
            $('a[href="/' + currentPage + '"').parent().addClass('active');
        }
    }
    
    function initThemeSwitcher() {
        darkModeButton.innerHTML = themeSettings.light.icon;
        darkModeButton.classList.add('darkModeButton');
        
        darkModeButton.addEventListener('click', function(){
            switch(document.documentElement.getAttribute('data-theme')) {
                case 'dark':
                    lightMode();
                    break;

                case 'light':
                default:
                    darkMode();
                    break;
            }
        });
        
        var newItem = document.createElement('li');
        newItem.appendChild(darkModeButton);
        menuList.insertBefore(newItem, menuList.childNodes[menuList.childNodes - 1]);
    }
    

    // Settings for dark mode
    function darkMode() {
        darkModeButton.innerHTML = themeSettings.dark.icon;
        document.documentElement.setAttribute('data-theme', 'dark');
        syntaxHighlightSource.setAttribute('href', themeSettings.dark.hljs);
        localStorage.setItem("theme", "dark");
    }

    // Settings for light mode
    function lightMode() {
        darkModeButton.innerHTML = themeSettings.light.icon;
        document.documentElement.setAttribute('data-theme', '');
        syntaxHighlightSource.setAttribute('href', themeSettings.light.hljs);
        localStorage.setItem("theme", "");
    }

    function checkTheme() {
        const localStorageTheme = localStorage.getItem("theme");
        switch(localStorageTheme) {
            case "dark":
                darkMode();
                break;
            
            default:
                lightMode();
                break;
        }
    }

    // Check if the theme is stored in session
    window.onload = function() {
        initThemeSwitcher();
        checkTheme();
        highlightMenuLink();
    }

    //  open and close nav 
    $('#navbar-toggle').click(function() {
      $('nav ul').slideToggle();
    });

    // Hamburger toggle
    $('#navbar-toggle').on('click', function() {
      this.classList.toggle('active');
    });

    // Click outside the dropdown will remove the dropdown class
    $('html').click(function() {
      $('.navbar-dropdown').hide();
    });
</script> -->
</body>
</html>