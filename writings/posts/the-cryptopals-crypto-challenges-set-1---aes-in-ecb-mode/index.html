<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>The Cryptopals Crypto Challenges: Set 1 -  AES in ECB Mode | megacolorboy</title>
	<link rel="stylesheet" href="/static/css/main.css" type="text/css">
	<link rel="stylesheet" href="/static/vendor/hljs/css/default.min.css">
	<!-- Add OG tags  -->
</head>
<body class="details-page writings">
	<!-- Navbar -->
	<header class="header">
	<div class="author">
		<a href="/">
			<div class="logo"></div>
			<p>megacolorboy</p>
		</a>
	</div>
	<nav>
		<ul class="menu">
			
				<li><a href="/about">About</a></li>
			
				<li><a href="/writings">Writings</a></li>
			
				<li><a href="/til">Today I Learned</a></li>
			
		</ul>
	</nav>
</header>

<div class="article-top">
	<a class="back" href="/writings"><span>&larr;</span> Back</a>
	<p class="date">Published on December 21st, 2017</p>	
</div>

<main>
	<section class="article-head">
		<p class="cat">Cryptography</p>
		<h1>The Cryptopals Crypto Challenges: Set 1 -  AES in ECB Mode</h1>
		
			<p>Decrypt a Base64 encoded file that is encrypted with an AES-128 Cipher in ECB mode.</p>
		
		<p class="date">3 minutes read</p>
	</section>
	<article>
		<p>This is the <a href="http://cryptopals.com/sets/1/challenges/7">seventh
challenge</a> of Set 1 in The
Cryptopals Crypto Challenges website. Previously, I spoke about these
challenges and provided walkthroughs for the previous challenges, if you
haven't read them, here are the links:</p>

<ul>
<li><a href="/posts/the-cryptopals-crypto-challenges">The Cryptopals Crypto
Challenges</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-convert-hex-to-base64">The Cryptopals Crypto Challenges: Set 1 - Convert Hex to
Base64</a></li>
<li><a href="/posts/base64-encoding-decoding-using-bitwise-manipulation-in-c">Base64 Encoding / Decoding using Bitwise Manipulation in
C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-fixed-xor">The Cryptopals Crypto Challenges: Set 1 - Fixed XOR
Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-single-byte-xor-cipher">The Cryptopals Crypto Challenges: Set 1 - Single-Byte XOR
Cipher</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-detect-single-character-xor">The Cryptopals Crypto Challenges: Set 1 - Detect Single-Character
XOR</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-implement-repeating-key-xor">The Cryptopals Crypto Challenges: Set 1 - Implement Repeating-Key
XOR</a></li>
<li><a href="/posts/hamming-distance-algorithm-in-c">Hamming Distance Algorithm in
C++</a></li>
<li><a href="/posts/the-cryptopals-crypto-challenges-set-1-break-repeating-key-xor">The Cryptopals Crypto Challenges: Set 1 - Break Repeating-Key
XOR</a></li>
</ul>

<p>For this challenge, you are given a
<a href="http://cryptopals.com/static/challenge-data/7.txt">file</a>, which
contains a ciphertext that has been encrypted using <strong><em>AES-128 Cipher</em></strong>
with <strong><em>ECB (Electronic Codebook)</em></strong> mode and then encoded using Base64.
Decrypt it.</p>

<p>In order to decrypt it, you are given a key:</p>

<pre>
    <code class="plaintext">
    YELLOW SUBMARINE
    </code>
</pre>

<h2>What is AES?</h2>

<p><a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">Advanced Encryption
Standard</a>
a.k.a <strong><em>Rjindael</em></strong>, which was developed by two belgian cryptographers,
<a href="https://en.wikipedia.org/wiki/Vincent_Rijmen">Vincent Rijmen</a> and <a href="https://en.wikipedia.org/wiki/Joan_Daemen">Joan
Daemen</a>. <strong><em>Rjindael</em></strong> is a
family of ciphers with various block and key sizes.</p>

<p><strong><em>AES-128</em></strong> is commonly used but there are also larger key sizes such as
<strong><em>192</em></strong> and <strong><em>256</em></strong> bits. Similar to <strong><em>XOR cipher</em></strong>, it uses the same
key to encrypt and decrypt the message. Till date, there isn't any
publication that states if whether <strong><em>AES</em></strong> is broken but even if you
were to break it, it will take atleast a <strong><em>billion years</em></strong> with a
supercomputer, which could beyond the age of the universe.</p>

<h2>What is ECB Mode?</h2>

<p>What if your plaintext is longer than (in this case, 128 bits) the
keysize? This is where <strong><em>ECB</em></strong> comes into the picture. <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">ECB (Electronic
Codebook)</a>
is a cipher mode that is used to repeat the key until it covers the
entire plaintext (similar to <a href="/posts/the-cryptopals-crypto-challenges-set-1-implement-repeating-key-xor">Repeating-Key XOR
Cipher</a>)
and then each <strong><em>block</em></strong> is independently encrypted using the <strong><em>AES</em></strong>
algorithm to produce the desired ciphertext.</p>

<p>This challenge is not that hard, in fact, it's completely trivial and
more like an introduction of <strong><em>AES Cipher</em></strong>. There are so many ways to
solve this problem but I chose to solve this problem using <strong><em>OpenSSL</em></strong>
and other commandline tools such as <strong><em>xxd</em></strong> (used to print the hexdump of
a file) on my UNIX terminal.</p>

<p>Here's the solution:</p>

<pre>
    <code class="bash">
    openssl enc -aes-128-ecb -d -a -in secret.txt -K $(echo "YELLOW SUBMARINE" | xxd -p) -iv 1 | head
    </code>
</pre>

<p>This is the decrypted message:</p>

<pre>
    <code class="plaintext">
    I'm back and I'm ringin' the bell
    A rockin' on the mike while the fly girls yell
    In ecstasy in the back of me
    Well that's my DJ Deshay cuttin' all them Z's
    Hittin' hard and the girlies goin' crazy
    Vanilla's on the mike, man I'm not lazy.

    I'm lettin' my drug kick in
    It controls my mouth and I begin
    To just let it flow, let my concepts go
    </code>
</pre>

<p>Initially, I was planning to write an implementation of <strong><em>AES</em></strong> for fun,
but then I decided to make it a side project that I can work on as there
are a lot of things about <strong><em>AES</em></strong> that I'd like to talk about in the
future.</p>

<p>Stay tuned for the next challenge!</p>

	</article>
</main>

<script src="/static/vendor/jquery/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="/static/vendor/hljs/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>